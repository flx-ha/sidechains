// Copyright (c) 2017 The Bitcoin Core developers
// Distributed under the MIT software license, see the accompanying
// file COPYING or http://www.opensource.org/licenses/mit-license.php.

// TODO move all BMM Cache tests to bmmcache_tests.cpp
#include "bmmcache.h"
#include "base58.h"
#include "chainparams.h"
#include "consensus/validation.h"
#include "core_io.h"
#include "miner.h"
#include "policy/policy.h"
#include "random.h"
#include "script/sigcache.h"
#include "sidechain.h"
#include "uint256.h"
#include "util.h"
#include "utilstrencodings.h"
#include "validation.h"

#include "test/test_bitcoin.h"

#include <boost/test/unit_test.hpp>

static CFeeRate blockMinFeeRate = CFeeRate(DEFAULT_BLOCK_MIN_TX_FEE);

static BlockAssembler AssemblerForTest(const CChainParams& params) {
    BlockAssembler::Options options;

    options.nBlockMaxWeight = MAX_BLOCK_WEIGHT;
    options.blockMinFeeRate = blockMinFeeRate;
    return BlockAssembler(params, options);
}

BOOST_FIXTURE_TEST_SUITE(sidechain_tests, DogeChain100Setup)

BOOST_AUTO_TEST_CASE(sidechain_obj)
{
    // Test sidechain object (for leveldb) scripts

    SidechainWT wt;
    wt.nSidechain = 0;
    wt.strDestination = "";
    wt.strRefundDestination = "";
    wt.amount = 0;
    wt.mainchainFee = 0;
    wt.status = WT_UNSPENT;
    wt.hashBlindWTX = uint256();

    CScript script = wt.GetScript();

    std::vector<unsigned char> vch;
    BOOST_CHECK(script.IsSidechainObj(vch));

    SidechainObj* parsed = ParseSidechainObj(vch);
    BOOST_CHECK(parsed);
}

BOOST_AUTO_TEST_CASE(sidechain_bmm_valid_not_verified)
{
    // Test CheckBlock a block with valid BMM when -verifybmmcheckblock = false
    const CChainParams chainparams = Params();

    BOOST_CHECK(chainActive.Height() == COINBASE_MATURITY);

    // Set -verifybmmcheckblock arg to false
    gArgs.ForceSetArg("-verifybmmcheckblock", "0");
    gArgs.ForceSetArg("-verifybmmacceptblock", "0");
    gArgs.ForceSetArg("-verifybmmacceptheader", "0");
    gArgs.ForceSetArg("-verifybmmreadblock", "0");

    // Generate BMM block
    CBlock block;
    std::string strError = "";
    BOOST_CHECK(AssemblerForTest(Params()).GenerateBMMBlock(block, strError, nullptr, std::vector<CMutableTransaction>(), uint256(), GetCoinbaseScript()));

    std::shared_ptr<const CBlock> shared_pblock = std::make_shared<const CBlock>(block);
    BOOST_CHECK(ProcessNewBlock(chainparams, shared_pblock, true, nullptr, true /* fUnitTest */));

    BOOST_CHECK(chainActive.Height() == COINBASE_MATURITY + 1);
}

BOOST_AUTO_TEST_CASE(sidechain_bmm_valid)
{
    // A real example of a BMM (blinded) block before BMM proof has been added
    std::string blockHex = "00000020b1e9cedbf0f6ee194d88a795fe7d0a53b9c0355921b2155ef16757de27388130814b76a3d8af13bbb73118eadb735b09f6f8190683f4f221ebdb75edb6bdfd3df0a12b5dffff7f200100000000030000003f000000000000000000000000000000000000000000000000000000000000000000000000000001030000003f0001010000000000000000000000000000000000000000000000000000000000000000ffffffff03520101ffffffff020000000000000000000000000000000000266a24aa21a9ede2f61c3f71d1defd3fa999dfa36953755c690689799962b48bebd836974e8cf90120000000000000000000000000000000000000000000000000000000000000000000000000";

    // A real example of a mainchain coinbase BMM h* commitment
    std::string coinbaseHex = "020000000001010000000000000000000000000000000000000000000000000000000000000000ffffffff0502f3000101ffffffff03cc02062a01000000232102cda85899a9c51865e2482db94287f783ded2c77bb70ba327f3d51db67b318f59ac0000000000000000346a24d16173687f5fbe3f1cd68618c06e3236e3c73ee9081c56d0e185a8ea411343529f8ae55700bf0000000833323334363536330000000000000000266a24aa21a9ed607fb8779d041f21a8bb6292f63d82c6b2b4f7c470cc5481f3b371779a6384f50120000000000000000000000000000000000000000000000000000000000000000000000000";

    // A real example of the partial merkle tree proof used for BMM proof
    std::string proofHex = "00000020ec24cb98378b55fd9a570beb8a8d1b347388d29a29aba43b594a4c3cb1d5c18fd9030dbeee976380722d48f2c62b950580a0612060cf21800a84a5b2e37b63a925a22b5dffff5f1dab2c700002000000027beb77071246b2c3dd64ac5e755a35711700c0340faa1cd08a0b08824ae08285329fb8a709c787029e92d0cd12391380f3ad2935818123151c4607fd29ea195b0103";

    // Deserialize the example block
    CDataStream ss(ParseHex(blockHex), SER_DISK, PROTOCOL_VERSION);
    CBlock block;
    block.Unserialize(ss);

    // Should fail here, no BMM proof in block
    BOOST_CHECK(!VerifyCriticalHashProof(block));

    // Add BMM proof to the blck
    BOOST_CHECK(DecodeHexTx(block.criticalTx, coinbaseHex));
    block.criticalProof = proofHex;

    // Should fail here again, as we have no connection to the mainchain and
    // haven't cached the validation of this BMM proof
    BOOST_CHECK(!VerifyCriticalHashProof(block));

    // Cache the validation of this BMM proof
    bmmCache.CacheBMMProof(block.GetHash(), block.criticalTx.GetHash());
    BOOST_CHECK(bmmCache.HaveBMMProof(block.GetHash(), block.criticalTx.GetHash()));

    // It should pass now that we have added the BMM proof to the block and
    // cached the validation of that BMM proof.
    BOOST_CHECK(VerifyCriticalHashProof(block));
}

BOOST_AUTO_TEST_CASE(sidechain_bmm_invalid_verified)
{
    // TODO
    //
    // Figure out a way of running tests with valid / invalid BMM where BMM
    // is verified as usual. This is complicated because the code to verify BMM
    // requires a connection to the mainchain. This can be tested as part of the
    // integration script but would also be helpful to simulate a mainchain
    // providing / not providing the merkle proof of a BMM commitment in a
    // mainchain block.
    //
    // One sort of hacky option would be to add a parameter to ProcessNewBlock
    // which accepts the BMM proof. If the proof is passed in we can make the
    // code use that proof instead of asking for it from the mainchain, and skip
    // the mainchain connection checks.
    //
    // Right now this test is doing nothing helpful.

    // Test CheckBlock without valid BMM when -verifybmmcheckblock = true
    const CChainParams chainparams = Params();

    BOOST_CHECK(chainActive.Height() == COINBASE_MATURITY);

    // Generate BMM block
    CBlock block;
    std::string strError = "";
    BOOST_CHECK(AssemblerForTest(Params()).GenerateBMMBlock(block, strError, nullptr, std::vector<CMutableTransaction>(), uint256(), GetCoinbaseScript()));

    // Set -verifybmmcheckblock arg to true
    gArgs.ForceSetArg("-verifybmmcheckblock", "1");

    std::shared_ptr<const CBlock> shared_pblock = std::make_shared<const CBlock>(block);
    BOOST_CHECK(!ProcessNewBlock(chainparams, shared_pblock, true, nullptr, true /* fUnitTest */));

    BOOST_CHECK(chainActive.Height() == COINBASE_MATURITY);

    // Set -verifybmmcheckblock arg back to default (gArgs effect all tests)
    gArgs.ForceSetArg("-verifybmmcheckblock", "0");
}

// TODO although more complicated than it may seem at first, it would be nice
// if we could also have a valid test that uses the DogeChain100 and extends
// that chain. For now we can call VerifyCriticalHashProof on the block.

BOOST_AUTO_TEST_CASE(sidechain_bmm_cache)
{
    uint256 hashRand = GetRandHash();

    // Reject null block hash
    bmmCache.CacheBMMProof(uint256(), hashRand);
    BOOST_CHECK(!bmmCache.HaveBMMProof(uint256(), hashRand));

    // Reject null critical tx hash
    bmmCache.CacheBMMProof(hashRand, uint256());
    BOOST_CHECK(!bmmCache.HaveBMMProof(hashRand, uint256()));

    // Accept valid
    uint256 hash1 = GetRandHash();
    uint256 hash2 = GetRandHash();
    bmmCache.CacheBMMProof(hash1, hash2);
    BOOST_CHECK(bmmCache.HaveBMMProof(hash1, hash2));

    // Reject another
    bmmCache.CacheBMMProof(uint256(), hash1);
    BOOST_CHECK(!bmmCache.HaveBMMProof(uint256(), hashRand));

    // Accept many & check that they have been cached
    for (int i = 0; i <= 1776; i++) {
        uint256 hashRand1 = GetRandHash();
        uint256 hashRand2 = GetRandHash();
        bmmCache.CacheBMMProof(hashRand1, hashRand2);
        BOOST_CHECK(bmmCache.HaveBMMProof(hashRand1, hashRand2));
    }

    // Check that the first cached item still can be looked up
    BOOST_CHECK(bmmCache.HaveBMMProof(hash1, hash2));
}


// TODO :
// sidechain_wt
// sidechain_wt^
// sidechain deposit proof
// sidechain wt reuse in WT^
// sidechain deposit reuse
// sidechain deposit maturity

// TODO finish
BOOST_AUTO_TEST_CASE(sidechain_deposit)
{
    BOOST_CHECK(!psidechaintree->HaveDeposits());

    const CChainParams chainparams = Params();

    BOOST_CHECK(chainActive.Height() == COINBASE_MATURITY);
/*
    // Generate BMM block
    CBlock block;
    std::string strError = "";
    BOOST_CHECK(AssemblerForTest(Params()).GenerateBMMBlock(block, strError, std::vector<CMutableTransaction>(), uint256(), GetCoinbaseScript()));


    std::shared_ptr<const CBlock> shared_pblock = std::make_shared<const CBlock>(block);
    BOOST_CHECK(ProcessNewBlock(chainparams, shared_pblock, true, nullptr));

    BOOST_CHECK(chainActive.Height() == 101);
*/
}

std::vector<SidechainDeposit> Get10TestDeposits()
{
    // Serialization of 10 real sidechain deposits, in valid CTIP spend order.
    // None of these deposits spend the same transaction.

    std::string strD1 = "44002273534477645551754e753674314a6b6569385035387469735a585454746f355145310065cd1d00000000020000000176cd3aebb16f689dbe75b32995edb34ad5d4c57803b9695d03cf54172cc9e6550000000048473044022042e440b9a6dcea52dba916c530a040dd00f9d3dea73d95474ec8b3c01c2be7cc02204e9fbddaa168727dee0a5264236ade68a07a973be58e93aa7c445726e5232a0101ffffffff0380fd9c76000000001976a914f945cecaf63f112f5d1288acf1ae43f75d916d2d88ac0000000000000000246a2273534477645551754e753674314a6b6569385035387469735a585454746f355145310065cd1d000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003043758b70a503f7a47454343f1e9a16f9e376fd41ff2a0ce90b6a49941dfbf9c35b0bce4e1576d4a7895366964ecf116665e9b61b0625fe71ee065e33c4ab4a3a5c4fdd5fffff7f2000000000060000000446546d864db9cdac89e2514fd5e35a53446d08251ee2eea01df3133ff2a8c8d1b1497c150909aa546738a66b922c7216fb99a1a1fd9d979b6d6cb43eb0da34b3bc985350b4628f895fd2eb3493204397b2005172dcc8e61730c6ee20ea78bbbdf699c49a19e37b413cef1569e2423d985c79e2d3ab5e580c9780bab0e7cbe38f011702000000";

    std::string strD2 = "44002273534477645551754e753674314a6b6569385035387469735a585454746f355145310065cd1d000000000200000002a70863785b471792727c430624040875d36a3a2d89e511f75413dd6c64dc55980000000048473044022028b18d2882e1ec900fa236043fc3024c17a1d547d41a56d7bb6f95cdfc08b6a602203aeb0b39f11d0d470c22a3a1fc291179063fc19269ce3adf5d3c66c23afa8d3201ffffffffb1497c150909aa546738a66b922c7216fb99a1a1fd9d979b6d6cb43eb0da34b3020000008a473044022071a7056730981bb01ca80fd22887f4bab01b6054b40c34a24623c927950ab2580220762aa0bb5c08a76a9eb779f7ba70d6aa2d8d8bb0a2c51a9d942d9f0a38e771630141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380fd9c76000000001976a9145056e18e822203efa70b563996ed625db27d729688ac0000000000000000246a2273534477645551754e753674314a6b6569385035387469735a585454746f3551453100ca9a3b000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003043758b70a503f7a47454343f1e9a16f9e376fd41ff2a0ce90b6a49941dfbf9c35b0bce4e1576d4a7895366964ecf116665e9b61b0625fe71ee065e33c4ab4a3a5c4fdd5fffff7f20000000000600000004cd1eb264283f4de9785568235040789fbb7234039300ae619ef4ce01191079fd2dc8ffb0e298cc66f37d25a8d0f3aeb4f388889d7cce3a49e959ead7e073352a47cbf40c3a19d790810a97b3281e2ad30c404309e6085d25dbd59926711aa10df699c49a19e37b413cef1569e2423d985c79e2d3ab5e580c9780bab0e7cbe38f011b02000000";

    std::string strD3 = "44002273595447446664557a566f48784e534874354b4a5a617177596a70794b6579614879002d31010000000002000000025d96d7eebbd47f1a5c9ab25129d2dd9f5f1f4803c721a51a08767cf8c469ea13000000004847304402202c899ec96a1ec853b6cb599bb10d3bc2c1c8e5bf72ac769402c829e4a4294b370220076eb06388fe81b4b1dc55d8ccecde30540320584da49ee7ff69f77ee6e2301801ffffffff2dc8ffb0e298cc66f37d25a8d0f3aeb4f388889d7cce3a49e959ead7e073352a020000008b483045022100972dd307e0e8cbca1bf7b3037fe0bdf714f25b8fef5cf4cd270c262b918e96120220295780e3f131911a88fe22ceaa7a21b6392841dea7191f608b8248ab91e0f1e80141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380353993000000001976a9147c65b28aeab71c9f01cd56f6057add2802e14b8988ac0000000000000000246a2273595447446664557a566f48784e534874354b4a5a617177596a70794b657961487900f7cb3c000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003043758b70a503f7a47454343f1e9a16f9e376fd41ff2a0ce90b6a49941dfbf9c35b0bce4e1576d4a7895366964ecf116665e9b61b0625fe71ee065e33c4ab4a3a5c4fdd5fffff7f20000000000600000004cd1eb264283f4de9785568235040789fbb7234039300ae619ef4ce01191079fd2dc8ffb0e298cc66f37d25a8d0f3aeb4f388889d7cce3a49e959ead7e073352a47cbf40c3a19d790810a97b3281e2ad30c404309e6085d25dbd59926711aa10df699c49a19e37b413cef1569e2423d985c79e2d3ab5e580c9780bab0e7cbe38f012b02000000";

    std::string strD4 = "4400227361784b66656f6779614665746a346b34435478634c5272775256785a4d3559364c002d3101000000000200000002c66364b25e1eeba54046d9f600d8bb391e0fd78cbc9d3490d6b106ddf183c51d0000000049483045022100ab04bfb85f620960df05110a96e50b0ec004f9fd1f68f5bc74acacfae83a2f86022065d8ea40a80bffb12e8632d5249bfc06337f9d43b63b2ee385ec983072be7a0301ffffffff47cbf40c3a19d790810a97b3281e2ad30c404309e6085d25dbd59926711aa10d020000008a473044022072bbdc49d689cb19edefc770ce2eeda12ea83ab1b1bfc8ccdb30dff247fcc7a802203d2fd4e45b73c409f0f0980d99a013731104ba413d4aaa32785b42cc238c06df0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380353993000000001976a9145ec15482c8f1e9d3185322798dfc0118f629c21d88ac0000000000000000246a227361784b66656f6779614665746a346b34435478634c5272775256785a4d3559364c0024fd3d000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003043758b70a503f7a47454343f1e9a16f9e376fd41ff2a0ce90b6a49941dfbf9c35b0bce4e1576d4a7895366964ecf116665e9b61b0625fe71ee065e33c4ab4a3a5c4fdd5fffff7f20000000000600000003059bb0c72c856a87c6d92e30ab029453775e044694e51432f14e06286bb766f6906e9865e1dfbe9ce2310c466ea7cfdd9cc75f24d44156c74472c88dacadd8f3753e911443fc996df926f314c1cc4ad9c1ae0f6e1d4e302553059dd769740bfe011d02000000";

    std::string strD5 = "4400227361784b66656f6779614665746a346b34435478634c5272775256785a4d3559364c005a62020000000002000000028802655cf59b45cfb6e42776ed64bc7125adff21bf3ca68fdc827098fc381929000000004847304402205980b45851449d8ce48e2a5a1e73e8041211b8b6e4aaa9eedbd6c7ec4334a6ff02205c3a1cc744e96f223f95dc3d0cc54c1d1b9960ec025243e8f1e290ee33b3b7a601ffffffff906e9865e1dfbe9ce2310c466ea7cfdd9cc75f24d44156c74472c88dacadd8f3020000008a47304402206cd063e7c1c6553f0811d695dc934a5f7c437b2c75d5423eacae0d215abe8d9f02200b1bdb6273a92bde129fb91138b8cc132cc17e3166f3de23e754c7f2995f60bb0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380080892000000001976a914fc553fb8e16f9a91c3ceeaa551b9bace8b1be0c588ac0000000000000000246a227361784b66656f6779614665746a346b34435478634c5272775256785a4d3559364c007e5f40000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003043758b70a503f7a47454343f1e9a16f9e376fd41ff2a0ce90b6a49941dfbf9c35b0bce4e1576d4a7895366964ecf116665e9b61b0625fe71ee065e33c4ab4a3a5c4fdd5fffff7f20000000000600000003059bb0c72c856a87c6d92e30ab029453775e044694e51432f14e06286bb766f6906e9865e1dfbe9ce2310c466ea7cfdd9cc75f24d44156c74472c88dacadd8f3753e911443fc996df926f314c1cc4ad9c1ae0f6e1d4e302553059dd769740bfe012d02000000";

    std::string strD6 = "440022736331556d647866566e61594e5968696843484c48704b467a416a32756b5764563800752b7d000000000200000002753e911443fc996df926f314c1cc4ad9c1ae0f6e1d4e302553059dd769740bfe000000006a4730440220074261e12b25a8bcb990e9c9447c52b366bd3b058527f531d3781e79e2346ac3022078ad4a82a7a06752346e3a18105e54a19a089fdfba2c82931189bb65bcb8a5af012102a7ba73ddec25e0dd8b73fd92a71ae9df9488e5f32a0a45c02dd89ce7e4198659ffffffff753e911443fc996df926f314c1cc4ad9c1ae0f6e1d4e302553059dd769740bfe020000008b4830450221009dbb1e528381c332a793ec9a18751fd29c166ecb0101f30d2560ea8a61a0e13802206d4f2aef6158e58307c5455b433c4b2cd9b1601020fb1a9e47d2a9c26c686f950141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0340489014000000001976a914b8b90fb7fb4f2cdb2890f55ad50e1d784d245ee888ac0000000000000000246a22736331556d647866566e61594e5968696843484c48704b467a416a32756b5764563800f38abd000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003067de6b2a6e007fac6ce4838513dda9b06d88aa43eb5e12b1c144bfd8ad206f32e5ae7dcdf5f437f670f83d251676c76870e88659520b3ec0751eee64a3a69aa0aa4fdd5fffff7f20010000000c00000005fc5b4a13d206cffcb306f484c2b2dbeaf0e07a053bda11f8cc70b7515afa5be65028089e7253f83af7d146ebf4b24c1f94feb592f9e8dc390923fd58ed2307e99d0c41329b4812ad540aa3db92da5ced26517cd3c7e157249f85bb2d10fb49e7ff4ab69be095c64143f52c077dd7eb771854e7903f94062e7513f6502137ac74e1c3d31034f0e2eb56ea9e595a5a81e2f7cef4b5120db847f191700336fe637f022f0002000000";

    std::string strD7 = "44002273524a4b4657735846764a47373557576335485757335143677461546e546570734e00752b7d00000000020000000247cbf40c3a19d790810a97b3281e2ad30c404309e6085d25dbd59926711aa10d000000006946304302202c1aa7a28b605df90f8ecdab70c4f0d5be1292297e65b75e050b24beb47391e1021f34206f8f20142b5ab3862957f28226d90057edeff110cd193d75a3f1ea3b0c012102c7bd2c8a43cb9c2852ea010ba930201d4280f2d37fe416b890b11df4a963aa63ffffffff5028089e7253f83af7d146ebf4b24c1f94feb592f9e8dc390923fd58ed2307e9020000008b483045022100b2dce3cbd84ba10833487f25e0c3d1e5c9af4754f3f2f565d1a69e3522e53ccc022059745479b01cebcca419fac95cba63484214520befcde7b7c00e7d46401521390141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff034075c115000000001976a9149714c69c830195874b3f12398b08b00bfee9fcb088ac0000000000000000246a2273524a4b4657735846764a47373557576335485757335143677461546e546570734e0068b63a010000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003067de6b2a6e007fac6ce4838513dda9b06d88aa43eb5e12b1c144bfd8ad206f32e5ae7dcdf5f437f670f83d251676c76870e88659520b3ec0751eee64a3a69aa0aa4fdd5fffff7f20010000000c00000005af9f0228650a1a09d8af20743bc2936674942888a406403a3b12c15e2638f10f8fb46b698a2b53c0e107c7fb6339b800a354b7b149eb9420fd68c91d587ae5681cf2eb0f1f31a1be3e99eb1d729f0c9c990647a1f2c94d7968ba745d65c94879ff4ab69be095c64143f52c077dd7eb771854e7903f94062e7513f6502137ac74e1c3d31034f0e2eb56ea9e595a5a81e2f7cef4b5120db847f191700336fe637f02370002000000";

    std::string strD8 = "44002273524a4b4657735846764a47373557576335485757335143677461546e546570734e00752b7d000000000200000002906e9865e1dfbe9ce2310c466ea7cfdd9cc75f24d44156c74472c88dacadd8f3000000006a47304402205816b92e8aa3147cf1c0bc17d8b939dce969439b2c563fbe8b18e2cdb957ee08022049fbc7db808379b80f167cff669999b3b682f6d3800b3eca63b87eda2f8274080121022a1fcd360fd4efe0f7e9fcad67a73741389ef972b0f077780fe3742c2a59306dffffffff8fb46b698a2b53c0e107c7fb6339b800a354b7b149eb9420fd68c91d587ae568020000008b483045022100c7170a30ba7d1b40546a938fcd3ce7525705e7f7c79a885e2ac49e3d772d78b3022052d6a82cc3343a91d38fb563c1163a5d0cfd7e50df8eeaa6cdf1a86bc3967ae30141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff034075c115000000001976a91462a8293c71ab181c1866a607f4d7cfd8b7836e4988ac0000000000000000246a2273524a4b4657735846764a47373557576335485757335143677461546e546570734e00dde1b7010000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003067de6b2a6e007fac6ce4838513dda9b06d88aa43eb5e12b1c144bfd8ad206f32e5ae7dcdf5f437f670f83d251676c76870e88659520b3ec0751eee64a3a69aa0aa4fdd5fffff7f20010000000c00000005af9f0228650a1a09d8af20743bc2936674942888a406403a3b12c15e2638f10f8fb46b698a2b53c0e107c7fb6339b800a354b7b149eb9420fd68c91d587ae5681cf2eb0f1f31a1be3e99eb1d729f0c9c990647a1f2c94d7968ba745d65c94879ff4ab69be095c64143f52c077dd7eb771854e7903f94062e7513f6502137ac74e1c3d31034f0e2eb56ea9e595a5a81e2f7cef4b5120db847f191700336fe637f02570002000000";

    std::string strD9 = "4400227358474e446e726e6f724b69376371486b6d554b3357325a585035576b574448424d00d3fb2f0100000002000000032dc8ffb0e298cc66f37d25a8d0f3aeb4f388889d7cce3a49e959ead7e073352a000000006b483045022100b420bd964dc8d6967230b33a048a4db714ee65210ce5bd612f9a9d754e2d7a63022020ba855cad461a5cfd394f54fac29c652c3cab6ccb10991f13da522044935e9e012103eb2c067e1281dbd25d2f4849a3cf142e664474c45da81ff77c7cda0c97b94d57ffffffff572fff6c0472246ef4ccb1b3f72f5bcc4e6e1af2bb52297920a40216a63366c7000000004847304402203b5631aa635efd10c2b9dd0ee0e9ef536f680adefff02fcf0a1d9dcf4a29fb5402201ff9f8b1fe7325941e6b4d0a18d5aa698e66f89402fad14977a90cd546fd037501ffffffff1cf2eb0f1f31a1be3e99eb1d729f0c9c990647a1f2c94d7968ba745d65c94879020000008b483045022100ec73794f361cc68965eb35fcd69301f371452b3601ade1249833ce187eadfe6f0220142236a99219fb8ba975eff8455e1fef4ede1824d23b80778a89154c9be15b3a0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0300860e70000000001976a914c3500b9be07deea77a11a0be1250fd64c2c2922c88ac0000000000000000246a227358474e446e726e6f724b69376371486b6d554b3357325a585035576b574448424d00b0dde7020000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003067de6b2a6e007fac6ce4838513dda9b06d88aa43eb5e12b1c144bfd8ad206f32e5ae7dcdf5f437f670f83d251676c76870e88659520b3ec0751eee64a3a69aa0aa4fdd5fffff7f20010000000c000000059140a4ea323543d91fdb7e1c5a5df606594c5b0e12ff13ba2202f555de39c32f0954eee38c971bccf1e2de0e6ee6e8f64fd326141ca0122e1ba0ff22cae7156ef9176abeaaea8230461dad28bf13ffb02e0b3da541e7d4411dbdb86ea3dd226968db7db81038183e3b8589e379bb336ab8188e4e15397c89b7004bd5453984b5e1c3d31034f0e2eb56ea9e595a5a81e2f7cef4b5120db847f191700336fe637f023b0002000000";

    std::string strD10 = "44002273593772366963554d77707a455a67754141446b703975464b504b546f337a4a4b6a00e1f505000000000200000002b1497c150909aa546738a66b922c7216fb99a1a1fd9d979b6d6cb43eb0da34b3000000006a47304402204724a65810af1f00deda8301fec33f355949d914902233aaf90466a98a45baee022055938a9d1789157140d27e3316a5fcb7e98b3d0b2f656c457ee878c22fb7e7a201210399e7a9caad89842caa27856b3680624c26a98177b43e817c99ded2ff3e022267ffffffff0954eee38c971bccf1e2de0e6ee6e8f64fd326141ca0122e1ba0ff22cae7156e020000008a47304402205a7dc74bdccfd3425118854d1eaf92f33226130c63d7643016c905bdd35fc6380220285c3a2ca9638ed85725533e83506320aa6f80f081b644caf317dbe9ec314c9d0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0335529470000000001976a914278b79ff14626ab0f8142d9d21dc740b408bb8db88ac0000000000000000246a2273593772366963554d77707a455a67754141446b703975464b504b546f337a4a4b6a0091d3ed020000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003067de6b2a6e007fac6ce4838513dda9b06d88aa43eb5e12b1c144bfd8ad206f32e5ae7dcdf5f437f670f83d251676c76870e88659520b3ec0751eee64a3a69aa0aa4fdd5fffff7f20010000000c000000059140a4ea323543d91fdb7e1c5a5df606594c5b0e12ff13ba2202f555de39c32f0954eee38c971bccf1e2de0e6ee6e8f64fd326141ca0122e1ba0ff22cae7156ef9176abeaaea8230461dad28bf13ffb02e0b3da541e7d4411dbdb86ea3dd226968db7db81038183e3b8589e379bb336ab8188e4e15397c89b7004bd5453984b5e1c3d31034f0e2eb56ea9e595a5a81e2f7cef4b5120db847f191700336fe637f025b0002000000";

    CDataStream ss1(ParseHex(strD1), SER_DISK, CLIENT_VERSION);
    CDataStream ss2(ParseHex(strD2), SER_DISK, CLIENT_VERSION);
    CDataStream ss3(ParseHex(strD3), SER_DISK, CLIENT_VERSION);
    CDataStream ss4(ParseHex(strD4), SER_DISK, CLIENT_VERSION);
    CDataStream ss5(ParseHex(strD5), SER_DISK, CLIENT_VERSION);
    CDataStream ss6(ParseHex(strD6), SER_DISK, CLIENT_VERSION);
    CDataStream ss7(ParseHex(strD7), SER_DISK, CLIENT_VERSION);
    CDataStream ss8(ParseHex(strD8), SER_DISK, CLIENT_VERSION);
    CDataStream ss9(ParseHex(strD9), SER_DISK, CLIENT_VERSION);
    CDataStream ss10(ParseHex(strD10), SER_DISK, CLIENT_VERSION);

    // Unserialize the testing deposits

    SidechainDeposit d1;
    ss1 >> d1;
    SidechainDeposit d2;
    ss2 >> d2;
    SidechainDeposit d3;
    ss3 >> d3;
    SidechainDeposit d4;
    ss4 >> d4;
    SidechainDeposit d5;
    ss5 >> d5;
    SidechainDeposit d6;
    ss6 >> d6;
    SidechainDeposit d7;
    ss7 >> d7;
    SidechainDeposit d8;
    ss8 >> d8;
    SidechainDeposit d9;
    ss9 >> d9;
    SidechainDeposit d10;
    ss10 >> d10;

    std::vector<SidechainDeposit> vDeposit { d1, d2, d3, d4, d5, d6, d7, d8, d9, d10 };

    // Enable this for debugging
    //int i = 0;
    //for (const SidechainDeposit& d : vDeposit) {
    //    std::cout << "Deposit " << i << ":\n";
    //    std::cout << d.ToString() << std::endl;
    //    i++;
    //}

    return vDeposit;
}

std::vector<SidechainDeposit> Get30TestDeposits()
{
    // Serialization of 30 real sidechain deposits, in valid CTIP spend order.
    // Some of these spend a different outpoint of the same transaction.
    std::string strD1 = "44002273534477645551754e753674314a6b6569385035387469735a585454746f355145310065cd1d00000000020000000176cd3aebb16f689dbe75b32995edb34ad5d4c57803b9695d03cf54172cc9e6550000000048473044022042e440b9a6dcea52dba916c530a040dd00f9d3dea73d95474ec8b3c01c2be7cc02204e9fbddaa168727dee0a5264236ade68a07a973be58e93aa7c445726e5232a0101ffffffff0380fd9c76000000001976a914f945cecaf63f112f5d1288acf1ae43f75d916d2d88ac0000000000000000246a2273534477645551754e753674314a6b6569385035387469735a585454746f355145310065cd1d000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003043758b70a503f7a47454343f1e9a16f9e376fd41ff2a0ce90b6a49941dfbf9c35b0bce4e1576d4a7895366964ecf116665e9b61b0625fe71ee065e33c4ab4a3a5c4fdd5fffff7f2000000000060000000446546d864db9cdac89e2514fd5e35a53446d08251ee2eea01df3133ff2a8c8d1b1497c150909aa546738a66b922c7216fb99a1a1fd9d979b6d6cb43eb0da34b3bc985350b4628f895fd2eb3493204397b2005172dcc8e61730c6ee20ea78bbbdf699c49a19e37b413cef1569e2423d985c79e2d3ab5e580c9780bab0e7cbe38f011702000000";

    std::string strD2 = "44002273534477645551754e753674314a6b6569385035387469735a585454746f355145310065cd1d000000000200000002a70863785b471792727c430624040875d36a3a2d89e511f75413dd6c64dc55980000000048473044022028b18d2882e1ec900fa236043fc3024c17a1d547d41a56d7bb6f95cdfc08b6a602203aeb0b39f11d0d470c22a3a1fc291179063fc19269ce3adf5d3c66c23afa8d3201ffffffffb1497c150909aa546738a66b922c7216fb99a1a1fd9d979b6d6cb43eb0da34b3020000008a473044022071a7056730981bb01ca80fd22887f4bab01b6054b40c34a24623c927950ab2580220762aa0bb5c08a76a9eb779f7ba70d6aa2d8d8bb0a2c51a9d942d9f0a38e771630141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380fd9c76000000001976a9145056e18e822203efa70b563996ed625db27d729688ac0000000000000000246a2273534477645551754e753674314a6b6569385035387469735a585454746f3551453100ca9a3b000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003043758b70a503f7a47454343f1e9a16f9e376fd41ff2a0ce90b6a49941dfbf9c35b0bce4e1576d4a7895366964ecf116665e9b61b0625fe71ee065e33c4ab4a3a5c4fdd5fffff7f20000000000600000004cd1eb264283f4de9785568235040789fbb7234039300ae619ef4ce01191079fd2dc8ffb0e298cc66f37d25a8d0f3aeb4f388889d7cce3a49e959ead7e073352a47cbf40c3a19d790810a97b3281e2ad30c404309e6085d25dbd59926711aa10df699c49a19e37b413cef1569e2423d985c79e2d3ab5e580c9780bab0e7cbe38f011b02000000";

    std::string strD3 = "44002273595447446664557a566f48784e534874354b4a5a617177596a70794b6579614879002d31010000000002000000025d96d7eebbd47f1a5c9ab25129d2dd9f5f1f4803c721a51a08767cf8c469ea13000000004847304402202c899ec96a1ec853b6cb599bb10d3bc2c1c8e5bf72ac769402c829e4a4294b370220076eb06388fe81b4b1dc55d8ccecde30540320584da49ee7ff69f77ee6e2301801ffffffff2dc8ffb0e298cc66f37d25a8d0f3aeb4f388889d7cce3a49e959ead7e073352a020000008b483045022100972dd307e0e8cbca1bf7b3037fe0bdf714f25b8fef5cf4cd270c262b918e96120220295780e3f131911a88fe22ceaa7a21b6392841dea7191f608b8248ab91e0f1e80141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380353993000000001976a9147c65b28aeab71c9f01cd56f6057add2802e14b8988ac0000000000000000246a2273595447446664557a566f48784e534874354b4a5a617177596a70794b657961487900f7cb3c000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003043758b70a503f7a47454343f1e9a16f9e376fd41ff2a0ce90b6a49941dfbf9c35b0bce4e1576d4a7895366964ecf116665e9b61b0625fe71ee065e33c4ab4a3a5c4fdd5fffff7f20000000000600000004cd1eb264283f4de9785568235040789fbb7234039300ae619ef4ce01191079fd2dc8ffb0e298cc66f37d25a8d0f3aeb4f388889d7cce3a49e959ead7e073352a47cbf40c3a19d790810a97b3281e2ad30c404309e6085d25dbd59926711aa10df699c49a19e37b413cef1569e2423d985c79e2d3ab5e580c9780bab0e7cbe38f012b02000000";

    std::string strD4 = "4400227361784b66656f6779614665746a346b34435478634c5272775256785a4d3559364c002d3101000000000200000002c66364b25e1eeba54046d9f600d8bb391e0fd78cbc9d3490d6b106ddf183c51d0000000049483045022100ab04bfb85f620960df05110a96e50b0ec004f9fd1f68f5bc74acacfae83a2f86022065d8ea40a80bffb12e8632d5249bfc06337f9d43b63b2ee385ec983072be7a0301ffffffff47cbf40c3a19d790810a97b3281e2ad30c404309e6085d25dbd59926711aa10d020000008a473044022072bbdc49d689cb19edefc770ce2eeda12ea83ab1b1bfc8ccdb30dff247fcc7a802203d2fd4e45b73c409f0f0980d99a013731104ba413d4aaa32785b42cc238c06df0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380353993000000001976a9145ec15482c8f1e9d3185322798dfc0118f629c21d88ac0000000000000000246a227361784b66656f6779614665746a346b34435478634c5272775256785a4d3559364c0024fd3d000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003043758b70a503f7a47454343f1e9a16f9e376fd41ff2a0ce90b6a49941dfbf9c35b0bce4e1576d4a7895366964ecf116665e9b61b0625fe71ee065e33c4ab4a3a5c4fdd5fffff7f20000000000600000003059bb0c72c856a87c6d92e30ab029453775e044694e51432f14e06286bb766f6906e9865e1dfbe9ce2310c466ea7cfdd9cc75f24d44156c74472c88dacadd8f3753e911443fc996df926f314c1cc4ad9c1ae0f6e1d4e302553059dd769740bfe011d02000000";

    std::string strD5 = "4400227361784b66656f6779614665746a346b34435478634c5272775256785a4d3559364c005a62020000000002000000028802655cf59b45cfb6e42776ed64bc7125adff21bf3ca68fdc827098fc381929000000004847304402205980b45851449d8ce48e2a5a1e73e8041211b8b6e4aaa9eedbd6c7ec4334a6ff02205c3a1cc744e96f223f95dc3d0cc54c1d1b9960ec025243e8f1e290ee33b3b7a601ffffffff906e9865e1dfbe9ce2310c466ea7cfdd9cc75f24d44156c74472c88dacadd8f3020000008a47304402206cd063e7c1c6553f0811d695dc934a5f7c437b2c75d5423eacae0d215abe8d9f02200b1bdb6273a92bde129fb91138b8cc132cc17e3166f3de23e754c7f2995f60bb0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380080892000000001976a914fc553fb8e16f9a91c3ceeaa551b9bace8b1be0c588ac0000000000000000246a227361784b66656f6779614665746a346b34435478634c5272775256785a4d3559364c007e5f40000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003043758b70a503f7a47454343f1e9a16f9e376fd41ff2a0ce90b6a49941dfbf9c35b0bce4e1576d4a7895366964ecf116665e9b61b0625fe71ee065e33c4ab4a3a5c4fdd5fffff7f20000000000600000003059bb0c72c856a87c6d92e30ab029453775e044694e51432f14e06286bb766f6906e9865e1dfbe9ce2310c466ea7cfdd9cc75f24d44156c74472c88dacadd8f3753e911443fc996df926f314c1cc4ad9c1ae0f6e1d4e302553059dd769740bfe012d02000000";

    std::string strD6 = "440022736331556d647866566e61594e5968696843484c48704b467a416a32756b5764563800752b7d000000000200000002753e911443fc996df926f314c1cc4ad9c1ae0f6e1d4e302553059dd769740bfe000000006a4730440220074261e12b25a8bcb990e9c9447c52b366bd3b058527f531d3781e79e2346ac3022078ad4a82a7a06752346e3a18105e54a19a089fdfba2c82931189bb65bcb8a5af012102a7ba73ddec25e0dd8b73fd92a71ae9df9488e5f32a0a45c02dd89ce7e4198659ffffffff753e911443fc996df926f314c1cc4ad9c1ae0f6e1d4e302553059dd769740bfe020000008b4830450221009dbb1e528381c332a793ec9a18751fd29c166ecb0101f30d2560ea8a61a0e13802206d4f2aef6158e58307c5455b433c4b2cd9b1601020fb1a9e47d2a9c26c686f950141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0340489014000000001976a914b8b90fb7fb4f2cdb2890f55ad50e1d784d245ee888ac0000000000000000246a22736331556d647866566e61594e5968696843484c48704b467a416a32756b5764563800f38abd000000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003067de6b2a6e007fac6ce4838513dda9b06d88aa43eb5e12b1c144bfd8ad206f32e5ae7dcdf5f437f670f83d251676c76870e88659520b3ec0751eee64a3a69aa0aa4fdd5fffff7f20010000000c00000005fc5b4a13d206cffcb306f484c2b2dbeaf0e07a053bda11f8cc70b7515afa5be65028089e7253f83af7d146ebf4b24c1f94feb592f9e8dc390923fd58ed2307e99d0c41329b4812ad540aa3db92da5ced26517cd3c7e157249f85bb2d10fb49e7ff4ab69be095c64143f52c077dd7eb771854e7903f94062e7513f6502137ac74e1c3d31034f0e2eb56ea9e595a5a81e2f7cef4b5120db847f191700336fe637f022f0002000000";

    std::string strD7 = "44002273524a4b4657735846764a47373557576335485757335143677461546e546570734e00752b7d00000000020000000247cbf40c3a19d790810a97b3281e2ad30c404309e6085d25dbd59926711aa10d000000006946304302202c1aa7a28b605df90f8ecdab70c4f0d5be1292297e65b75e050b24beb47391e1021f34206f8f20142b5ab3862957f28226d90057edeff110cd193d75a3f1ea3b0c012102c7bd2c8a43cb9c2852ea010ba930201d4280f2d37fe416b890b11df4a963aa63ffffffff5028089e7253f83af7d146ebf4b24c1f94feb592f9e8dc390923fd58ed2307e9020000008b483045022100b2dce3cbd84ba10833487f25e0c3d1e5c9af4754f3f2f565d1a69e3522e53ccc022059745479b01cebcca419fac95cba63484214520befcde7b7c00e7d46401521390141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff034075c115000000001976a9149714c69c830195874b3f12398b08b00bfee9fcb088ac0000000000000000246a2273524a4b4657735846764a47373557576335485757335143677461546e546570734e0068b63a010000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003067de6b2a6e007fac6ce4838513dda9b06d88aa43eb5e12b1c144bfd8ad206f32e5ae7dcdf5f437f670f83d251676c76870e88659520b3ec0751eee64a3a69aa0aa4fdd5fffff7f20010000000c00000005af9f0228650a1a09d8af20743bc2936674942888a406403a3b12c15e2638f10f8fb46b698a2b53c0e107c7fb6339b800a354b7b149eb9420fd68c91d587ae5681cf2eb0f1f31a1be3e99eb1d729f0c9c990647a1f2c94d7968ba745d65c94879ff4ab69be095c64143f52c077dd7eb771854e7903f94062e7513f6502137ac74e1c3d31034f0e2eb56ea9e595a5a81e2f7cef4b5120db847f191700336fe637f02370002000000";

    std::string strD8 = "44002273524a4b4657735846764a47373557576335485757335143677461546e546570734e00752b7d000000000200000002906e9865e1dfbe9ce2310c466ea7cfdd9cc75f24d44156c74472c88dacadd8f3000000006a47304402205816b92e8aa3147cf1c0bc17d8b939dce969439b2c563fbe8b18e2cdb957ee08022049fbc7db808379b80f167cff669999b3b682f6d3800b3eca63b87eda2f8274080121022a1fcd360fd4efe0f7e9fcad67a73741389ef972b0f077780fe3742c2a59306dffffffff8fb46b698a2b53c0e107c7fb6339b800a354b7b149eb9420fd68c91d587ae568020000008b483045022100c7170a30ba7d1b40546a938fcd3ce7525705e7f7c79a885e2ac49e3d772d78b3022052d6a82cc3343a91d38fb563c1163a5d0cfd7e50df8eeaa6cdf1a86bc3967ae30141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff034075c115000000001976a91462a8293c71ab181c1866a607f4d7cfd8b7836e4988ac0000000000000000246a2273524a4b4657735846764a47373557576335485757335143677461546e546570734e00dde1b7010000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003067de6b2a6e007fac6ce4838513dda9b06d88aa43eb5e12b1c144bfd8ad206f32e5ae7dcdf5f437f670f83d251676c76870e88659520b3ec0751eee64a3a69aa0aa4fdd5fffff7f20010000000c00000005af9f0228650a1a09d8af20743bc2936674942888a406403a3b12c15e2638f10f8fb46b698a2b53c0e107c7fb6339b800a354b7b149eb9420fd68c91d587ae5681cf2eb0f1f31a1be3e99eb1d729f0c9c990647a1f2c94d7968ba745d65c94879ff4ab69be095c64143f52c077dd7eb771854e7903f94062e7513f6502137ac74e1c3d31034f0e2eb56ea9e595a5a81e2f7cef4b5120db847f191700336fe637f02570002000000";

    std::string strD9 = "4400227358474e446e726e6f724b69376371486b6d554b3357325a585035576b574448424d00d3fb2f0100000002000000032dc8ffb0e298cc66f37d25a8d0f3aeb4f388889d7cce3a49e959ead7e073352a000000006b483045022100b420bd964dc8d6967230b33a048a4db714ee65210ce5bd612f9a9d754e2d7a63022020ba855cad461a5cfd394f54fac29c652c3cab6ccb10991f13da522044935e9e012103eb2c067e1281dbd25d2f4849a3cf142e664474c45da81ff77c7cda0c97b94d57ffffffff572fff6c0472246ef4ccb1b3f72f5bcc4e6e1af2bb52297920a40216a63366c7000000004847304402203b5631aa635efd10c2b9dd0ee0e9ef536f680adefff02fcf0a1d9dcf4a29fb5402201ff9f8b1fe7325941e6b4d0a18d5aa698e66f89402fad14977a90cd546fd037501ffffffff1cf2eb0f1f31a1be3e99eb1d729f0c9c990647a1f2c94d7968ba745d65c94879020000008b483045022100ec73794f361cc68965eb35fcd69301f371452b3601ade1249833ce187eadfe6f0220142236a99219fb8ba975eff8455e1fef4ede1824d23b80778a89154c9be15b3a0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0300860e70000000001976a914c3500b9be07deea77a11a0be1250fd64c2c2922c88ac0000000000000000246a227358474e446e726e6f724b69376371486b6d554b3357325a585035576b574448424d00b0dde7020000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003067de6b2a6e007fac6ce4838513dda9b06d88aa43eb5e12b1c144bfd8ad206f32e5ae7dcdf5f437f670f83d251676c76870e88659520b3ec0751eee64a3a69aa0aa4fdd5fffff7f20010000000c000000059140a4ea323543d91fdb7e1c5a5df606594c5b0e12ff13ba2202f555de39c32f0954eee38c971bccf1e2de0e6ee6e8f64fd326141ca0122e1ba0ff22cae7156ef9176abeaaea8230461dad28bf13ffb02e0b3da541e7d4411dbdb86ea3dd226968db7db81038183e3b8589e379bb336ab8188e4e15397c89b7004bd5453984b5e1c3d31034f0e2eb56ea9e595a5a81e2f7cef4b5120db847f191700336fe637f023b0002000000";

    std::string strD10 = "44002273593772366963554d77707a455a67754141446b703975464b504b546f337a4a4b6a00e1f505000000000200000002b1497c150909aa546738a66b922c7216fb99a1a1fd9d979b6d6cb43eb0da34b3000000006a47304402204724a65810af1f00deda8301fec33f355949d914902233aaf90466a98a45baee022055938a9d1789157140d27e3316a5fcb7e98b3d0b2f656c457ee878c22fb7e7a201210399e7a9caad89842caa27856b3680624c26a98177b43e817c99ded2ff3e022267ffffffff0954eee38c971bccf1e2de0e6ee6e8f64fd326141ca0122e1ba0ff22cae7156e020000008a47304402205a7dc74bdccfd3425118854d1eaf92f33226130c63d7643016c905bdd35fc6380220285c3a2ca9638ed85725533e83506320aa6f80f081b644caf317dbe9ec314c9d0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0335529470000000001976a914278b79ff14626ab0f8142d9d21dc740b408bb8db88ac0000000000000000246a2273593772366963554d77707a455a67754141446b703975464b504b546f337a4a4b6a0091d3ed020000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003067de6b2a6e007fac6ce4838513dda9b06d88aa43eb5e12b1c144bfd8ad206f32e5ae7dcdf5f437f670f83d251676c76870e88659520b3ec0751eee64a3a69aa0aa4fdd5fffff7f20010000000c000000059140a4ea323543d91fdb7e1c5a5df606594c5b0e12ff13ba2202f555de39c32f0954eee38c971bccf1e2de0e6ee6e8f64fd326141ca0122e1ba0ff22cae7156ef9176abeaaea8230461dad28bf13ffb02e0b3da541e7d4411dbdb86ea3dd226968db7db81038183e3b8589e379bb336ab8188e4e15397c89b7004bd5453984b5e1c3d31034f0e2eb56ea9e595a5a81e2f7cef4b5120db847f191700336fe637f025b0002000000";

    std::string strD11 = "44002273593772366963554d77707a455a67754141446b703975464b504b546f337a4a4b6a00e1f505000000000200000002415f4cfdb60b7a7f00a55546942e1e7cec8fc43ef237626d0ab90fc92838700900000000484730440220307e6482fc5a4229768c4c0a61c879262bdf187166a7ebc8c08514d27736316902206db9b4bfe2251f33e75905a9a55a4ca0e5abf2f4c1de14aa2f07d130b6ebb3c601fffffffff9176abeaaea8230461dad28bf13ffb02e0b3da541e7d4411dbdb86ea3dd2269020000008b483045022100c8deb19c48e86a3854ce2d42d07518d8a8caeb6501019fa70d550ac46d38bfe8022010d19e23c47dadc16b73216c0fcbe5d05c2bbd963a61a25fea8d40410b73e1ae0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff03b54dfa8e000000001976a91422a56e54d44a633fb4681b34116e18fbbf64ea6788ac0000000000000000246a2273593772366963554d77707a455a67754141446b703975464b504b546f337a4a4b6a0072c9f3020000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003067de6b2a6e007fac6ce4838513dda9b06d88aa43eb5e12b1c144bfd8ad206f32e5ae7dcdf5f437f670f83d251676c76870e88659520b3ec0751eee64a3a69aa0aa4fdd5fffff7f20010000000c000000059140a4ea323543d91fdb7e1c5a5df606594c5b0e12ff13ba2202f555de39c32f365e547a39f413321d9dcf98a995a26d9210f4ccf53729e953871edf112d85ce47fdcea35047f3fac49122d03842aeec4d6ed432bac835eacec1f1885e8e225413af99a763fca6801fb401a51fecc222355c7aa092dfd3733259821296971cd4e1c3d31034f0e2eb56ea9e595a5a81e2f7cef4b5120db847f191700336fe637f026b0002000000";

    std::string strD12 = "44002273593772366963554d77707a455a67754141446b703975464b504b546f337a4a4b6a80f0fa02000000000200000002a0de96bbd8d7a5aa08a9836a8c7cb32110b3d4b59325f995af17ce39ad7e42e60000000049483045022100db700e591aeda8133ad40aea6dbc3a9c06a39f1e391470e375b96500d3f5c1a702203429021d7988923d6a110658ea266fd5de43fc5433579dfe05b6ca1496690a0e01ffffffff47fdcea35047f3fac49122d03842aeec4d6ed432bac835eacec1f1885e8e2254020000008a47304402201cc7d00cf3dab9df8c05b241036741aa67da9bc2a49209c4469322c92f95efc90220718c28b1db43ea7db784aa4e0e3a05b0e6e5367a03a1a5f028e058b95c26cad90141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff03353ef591000000001976a9145fc4db13b5293c95b789447cc75992ec8d38ee6088ac0000000000000000246a2273593772366963554d77707a455a67754141446b703975464b504b546f337a4a4b6a8062c4f6020000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003067de6b2a6e007fac6ce4838513dda9b06d88aa43eb5e12b1c144bfd8ad206f32e5ae7dcdf5f437f670f83d251676c76870e88659520b3ec0751eee64a3a69aa0aa4fdd5fffff7f20010000000c000000059140a4ea323543d91fdb7e1c5a5df606594c5b0e12ff13ba2202f555de39c32f365e547a39f413321d9dcf98a995a26d9210f4ccf53729e953871edf112d85ce47fdcea35047f3fac49122d03842aeec4d6ed432bac835eacec1f1885e8e225413af99a763fca6801fb401a51fecc222355c7aa092dfd3733259821296971cd4e1c3d31034f0e2eb56ea9e595a5a81e2f7cef4b5120db847f191700336fe637f02ab0002000000";

    std::string strD13 = "440022734c666a573745333743353476786538344379335852385732367571764a6d77774a80f0fa02000000000200000002b9753839b91a553db0b53467efc3a5ce3d186c05aa0cc373913e21424d04518100000000494830450221009d8d5ad1901ef1942177b5dcccf7d89d8d4078a5a4f68fb6da7e58406c97900c02203dce34ef0e728667fb2c939977fb67e0d3994bcedc64e39f5258d0b026dadc1901ffffffff13af99a763fca6801fb401a51fecc222355c7aa092dfd3733259821296971cd4020000008a473044022007868e50806a5985448b049e15259235041fe288a4cd6b6473b407badc32fc1002200f7539365a6dc948a82a98c6874c3db3fbdb6aa25732e35bc1004b4efe4cb7dd0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0300726f91000000001976a914864220051ca7e24f925fe21183878cfb562a705888ac0000000000000000246a22734c666a573745333743353476786538344379335852385732367571764a6d77774a0053bff9020000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003067de6b2a6e007fac6ce4838513dda9b06d88aa43eb5e12b1c144bfd8ad206f32e5ae7dcdf5f437f670f83d251676c76870e88659520b3ec0751eee64a3a69aa0aa4fdd5fffff7f20010000000c000000040c4c4433352d91d37b8ae49fefbfc8850031f638ce92eb0a689cac807cb8b3e6847f807ffc4568c4a420286b8eb65fb11b4ab5c3ce0a14246f6656a6c3f30700fe349d10c2336060ad0ddd2002722bc58adb1068b54323125bd05ab7446aa61ba8a2745cd8559dde44b8bf86fd7e8ba31cdf56f14f2581fd855fd7e0f381a886013d02000000";

    std::string strD14 = "440022734c666a573745333743353476786538344379335852385732367571764a6d77774a80f0fa02000000000200000002d9b7247faf2c1eef7a54bac20396b19f7e55eab0d911359ef27bc5d236c9397800000000484730440220446c2751d3dc4d9342e7e81784030b9784981fb78991fb5522a0e77343683b2602206075ea31a3ac92d95ca69e36b8f8829cbccf4ee3db623939a9ac85bca3d9940e01ffffffff847f807ffc4568c4a420286b8eb65fb11b4ab5c3ce0a14246f6656a6c3f30700020000008b4830450221008056efa54b8e8d934ce0ab9ebd5d08bf412197da627558f7b326ba688c1bdbb202204334199f0e331b140cb4ef59162faa06789376deaefee2ea23238eb471375e800141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0300726f91000000001976a9143de29a36a8ce9eabb40ffbe3dc780705c268cb9a88ac0000000000000000246a22734c666a573745333743353476786538344379335852385732367571764a6d77774a8043bafc020000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003067de6b2a6e007fac6ce4838513dda9b06d88aa43eb5e12b1c144bfd8ad206f32e5ae7dcdf5f437f670f83d251676c76870e88659520b3ec0751eee64a3a69aa0aa4fdd5fffff7f20010000000c000000040c4c4433352d91d37b8ae49fefbfc8850031f638ce92eb0a689cac807cb8b3e6847f807ffc4568c4a420286b8eb65fb11b4ab5c3ce0a14246f6656a6c3f30700fe349d10c2336060ad0ddd2002722bc58adb1068b54323125bd05ab7446aa61ba8a2745cd8559dde44b8bf86fd7e8ba31cdf56f14f2581fd855fd7e0f381a886015d02000000";

    std::string strD15 = "4400227353747834715563344c7637646a5055764b44486f45426341697253746f5257714e80f0fa02000000000200000002378d99178a5348f43a3bed59f07c271860e6a734d0d0e3eba8b39a9f602f89ea000000004847304402204532697c70a9ee4ad133c53deb9e503db3efc8bfed317a5a1c7ec837a86f22a7022077a121aabbaab8e9878e1ac46ec9d5a2d117751bdfcda1523ba7ffe27ada4d5f01fffffffffe349d10c2336060ad0ddd2002722bc58adb1068b54323125bd05ab7446aa61b020000008b483045022100a471b72c692d5a780d6f136d44a0128e5455cdaa1cfe86e92d0117a76cbb2a710220221918329cfc18738c1e890b79255b253c03f4c41b32daaef2360f3269bffd140141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0300726f91000000001976a914417d64993de40ace492db861929b6523c617d99488ac0000000000000000246a227353747834715563344c7637646a5055764b44486f45426341697253746f5257714e0034b5ff020000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003067de6b2a6e007fac6ce4838513dda9b06d88aa43eb5e12b1c144bfd8ad206f32e5ae7dcdf5f437f670f83d251676c76870e88659520b3ec0751eee64a3a69aa0aa4fdd5fffff7f20010000000c000000040c4c4433352d91d37b8ae49fefbfc8850031f638ce92eb0a689cac807cb8b3e6ef7aaf5303c7cd604359b65f5b28a4f6d1e85780c56eb2befb83eb3e0b94461c0695c71009bcb6f1e3dfcf5845ff3f208a57dfe4122697c5e465f08c68d36f4c56b4876bc240faab3d75a1395bf8c803427a833d9490564447fa7dc827cc3a46016d02000000";

    std::string strD16 = "4400227363374768537277793262396b676a69746e7131356476454372584b6b665351337180f0fa020000000002000000025c11dc573eb7d99835e2fb027748c23dd36befccb9188e0517b9a0449f6359b00000000049483045022100ee6b8fcdec75cf5b7a1395c0c3da573bdd97c923ff88e1a110a22e58d63ce0bc02202a6038953d93c924079d548f8add352a5c468adbd629ab83a2e8e56be35e57e901ffffffff0695c71009bcb6f1e3dfcf5845ff3f208a57dfe4122697c5e465f08c68d36f4c020000008b483045022100e91bb653e89f9f9afc2345068ce2af455c69a582a5d12a0be98e27dd229849690220632b64b370a2f773724be3d2a5b93cb0515a85246119e9acf725d583ee65c3a40141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0300726f91000000001976a914440f70c177617ef985693b6a5addbc69c140aaec88ac0000000000000000246a227363374768537277793262396b676a69746e7131356476454372584b6b66535133718024b002030000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac000000000100003067de6b2a6e007fac6ce4838513dda9b06d88aa43eb5e12b1c144bfd8ad206f32e5ae7dcdf5f437f670f83d251676c76870e88659520b3ec0751eee64a3a69aa0aa4fdd5fffff7f20010000000c000000040c4c4433352d91d37b8ae49fefbfc8850031f638ce92eb0a689cac807cb8b3e6ef7aaf5303c7cd604359b65f5b28a4f6d1e85780c56eb2befb83eb3e0b94461c0695c71009bcb6f1e3dfcf5845ff3f208a57dfe4122697c5e465f08c68d36f4c56b4876bc240faab3d75a1395bf8c803427a833d9490564447fa7dc827cc3a4601ad02000000";

    std::string strD17 = "440022735974554d6250623677686e666a36784e5335324877735839684e635674684c515700ac23fc0600000002000000085028089e7253f83af7d146ebf4b24c1f94feb592f9e8dc390923fd58ed2307e9000000006a473044022052118ce6da511e9af2ab369c9c7690a9d7419cc5dc01b78f54016acf046f3d8a02206be70d6b916a3871545d6ce0927aabc3be0ab928e17e0492a132777f9f4a22f201210341b1a00b33ae5ed03ada4c29a2a7c66715d9d8193a7ebd7afdbb877b544796c1ffffffff7579958d627116fd4b57b295a0b9f740c2a6df6fc2476b0d2efcbbbac348be0e0000000048473044022036547d5f66eea6faec78b3f9c84619603401cb2016dc740ccf5622f0fbd3ea2f0220651ebfe5cc93a5babc7849abf5cca60bc696433f5e6de9090976bf5da91a970501ffffffff979e9878e50882c59c3c3b52bf1757312191e34da7a341fb6247904e7ba2c51c0000000049483045022100a77d551186b4c6006e160e3998644ff5cc76e00734955506d2a820417f73d51e022045e6104011cf8a12948ad82a12ec24c2d13c955e40235d8b24ca20b17e63064701ffffffffb58b768e5e9405e71d9210b5ae2c8a967eab8bc171f01412af037749955b0c6c0000000049483045022100cc1a314e5949e596c7258a1fb417f66692ff00fb12b6ea271e24398731cba5d402204805b8ff745f31a837e9f54778c5e56d95bf261a2c31fae3326a5920d7e21e5a01ffffffffb823fe9e95de53483f51a3a9235041a884bf77f6517d6ce079f481bf155e9e9e0000000049483045022100989b4fd3fa100bf57687e524042c19db7f27e1c204fca76e98a8caf26e383ed902202f748ef06eaa4db08fefb536a4977f3f170ece77a1ff210d3e78106cdbffea6801ffffffffd5614496902a993207deb412c0a5adf18bafaf00c08cce54ca9a419da2d945c200000000494830450221008ccd3ea5d9bfac6e606c8131585a82d605bafff1fcb566d4bb37861df6083232022024728f6bb3bfda0ac61a11786d2baaa64aec2360cc55330f36d3c15cc607dd6b01fffffffff70cca7e555907ba78001c3515103d376a0bdecd10fa431a900c3a33d8d4f7190000000049483045022100f0cd4f4367d7b0e9f65331736761523e1aa2b422c3fc5a1f488a3d34534c108302207ae9bd56247a44643b41d0fa237d9e0bfa9973c9061b44f1d02b6b2e88caac5001ffffffff56b4876bc240faab3d75a1395bf8c803427a833d9490564447fa7dc827cc3a46020000008b483045022100a2c11c56de8f211e313e3ea87b50b4a9e88707d098370f97ad8eec742fddc72e02200c570175568f03510eb58d5f9ea3d1d76b14bbd51299419eba6b546d0e74adf80141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff03c0b1f713000000001976a914a9e445229b0e3e2e6aece44a3fba0a9321da4feb88ac0000000000000000246a22735974554d6250623677686e666a36784e5335324877735839684e635674684c515780d0d3fe090000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac0000000001000030690daf561c0bb58d6d6c6dc0127dbb89ff79ed1fc1b806189f20577a99d2915fd9a208a27e10b94dce3fd064fea3b2433e223a153926b77064cd2c1bed914b12e94fdd5fffff7f2000000000090000000586d73ea4477cb69657c0bf3e283390ea13becb3dadf906eca4951e1841c0ddf46be4ca00a382074d3b083973c95e3541de6b8c2619060b74633ade0d593a450e1c220416b6548b2e0e607e5bc47660e28d257a15b62d949642833fc82afe4e1bd0519b541e3d6c37bcbb3d9a446be166e02bc3a4887b742453efa5635199a84347b68947c809957d95677d114babf23f2bc3b1d4256c98ca8e81f4eac55cc735022f0002000000";

    std::string strD18 = "4400227356566a695034464d70537263544c636944766a52615376514664677a6e33454c56009699000200000002000000040954eee38c971bccf1e2de0e6ee6e8f64fd326141ca0122e1ba0ff22cae7156e000000006a4730440220034e1b3d86563d865bd6ff81d2f027b07b9268e4e84045b5103453a1b7ac760f022048234cfa64b9ff1a3017d260493315d36b588b87a43b7d0ffcc20d93849f03c701210303a6ffc597826b362b3b74e0f6bff6dad4b036b918b0e3036b82d630c05ab099ffffffffadb0c4acef2fdb23acea681a0c950dfefcea094cf263e4c9ed4192a9bb45ae240000000049483045022100ec5aaa21a6b3c6dc34f879a5c7ea3e5d98ebce4a7cefc604bad4e477280b71d302204f5020df703821656dbf08643ecafa4eef65b9e1705e234f91d7c05b473343f101ffffffffdab0ee4bcc4b1467e9b04ef431486455eb7fa1b973c3f2d23ec25ee7fadc7c360000000049483045022100a873131a7c4c96f2a54eb52cc1a075e79ba05f25198e87e49a42e2fe91a1a3a202204f73b118f72e443d4a209a3655ac0670e0b13f81d8c5531a7e9e4c3ab76810ac01ffffffff6be4ca00a382074d3b083973c95e3541de6b8c2619060b74633ade0d593a450e020000008a4730440220378f33cd8124649d9b5515868bf8987fb9b7ab46a29862feef59342d033842cb02205ad4e1f1ef204c7016775d3112535ff18028ea8ed00dbe1d6f231afa8db50bba0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff038044e52d000000001976a914986796362ce79a371b5f6226d8e41c111a6c175a88ac0000000000000000246a227356566a695034464d70537263544c636944766a52615376514664677a6e33454c5680666dff0b0000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac0000000001000030690daf561c0bb58d6d6c6dc0127dbb89ff79ed1fc1b806189f20577a99d2915fd9a208a27e10b94dce3fd064fea3b2433e223a153926b77064cd2c1bed914b12e94fdd5fffff7f2000000000090000000539801eddb8b0675a14da68353cb566da2448028e4501e9904583156203ceb64cd19a6e707836fb2d6fb187c9835b0dee0b11841562b8740ac932c2157fa96885c0ad016bce021b27b77302e3493f3f83ced41921f07ae00457346acf516819aad0519b541e3d6c37bcbb3d9a446be166e02bc3a4887b742453efa5635199a84347b68947c809957d95677d114babf23f2bc3b1d4256c98ca8e81f4eac55cc73502370002000000";

    std::string strD19 = "4400227356566a695034464d70537263544c636944766a52615376514664677a6e33454c56804120050000000002000000021cf2eb0f1f31a1be3e99eb1d729f0c9c990647a1f2c94d7968ba745d65c94879000000006a4730440220136087131db21b37361db1f006c4ab8f3a3cfe6a5c9702e85043b27e41e7fcbd02202f9e284c3d22499305dc2afed2542f382a423ee7f26d6ca0d488a8ccbe9618a6012102bc0c7571f4619974b2404f91f9d3464685d742a97d984d6eb870a474b2f3f6afffffffffd19a6e707836fb2d6fb187c9835b0dee0b11841562b8740ac932c2157fa96885020000008a4730440220086821114dc01f72f330050ad9a21fe4e6729170537cf52cd1a90e55233d8863022016ef645090e601e2e126f622f94675737346e66316b0dacd44d66fd01e71628b0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff03409d0810000000001976a91442123d7829733418ad5710f177b74b2a0ac7a18188ac0000000000000000246a227356566a695034464d70537263544c636944766a52615376514664677a6e33454c5600a88d040c0000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac0000000001000030690daf561c0bb58d6d6c6dc0127dbb89ff79ed1fc1b806189f20577a99d2915fd9a208a27e10b94dce3fd064fea3b2433e223a153926b77064cd2c1bed914b12e94fdd5fffff7f2000000000090000000539801eddb8b0675a14da68353cb566da2448028e4501e9904583156203ceb64cd19a6e707836fb2d6fb187c9835b0dee0b11841562b8740ac932c2157fa96885c0ad016bce021b27b77302e3493f3f83ced41921f07ae00457346acf516819aad0519b541e3d6c37bcbb3d9a446be166e02bc3a4887b742453efa5635199a84347b68947c809957d95677d114babf23f2bc3b1d4256c98ca8e81f4eac55cc73502570002000000";

    std::string strD20 = "4400227356566a695034464d70537263544c636944766a52615376514664677a6e33454c56804120050000000002000000028fb46b698a2b53c0e107c7fb6339b800a354b7b149eb9420fd68c91d587ae568000000006b483045022100ab5faf7cf28a206ccac3a407992b6c40b6b75c2fbf8222a4661059244d81b80302207e925e0bd6398e948c75449c4ae1f036474819773e22d5387f77f99c899e9402012103dc808a7f9b8341e5f8d9f2b40a0446d1a43c4d7d24b5d39c3b0d3ce6b9b55de5ffffffffc0ad016bce021b27b77302e3493f3f83ced41921f07ae00457346acf516819aa020000008b483045022100822e305166dbdd40aa9d8f604e8ef0145f4253d33d136a053d169adc4e18965602204fd206b14a1cdf8984baea32017f2845b6f8a9ac77d8a5de2da0c2f2d2a214ad0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff03409d0810000000001976a914b3d527ab7fcaa470aa4d9e355809691bad46fbe488ac0000000000000000246a227356566a695034464d70537263544c636944766a52615376514664677a6e33454c5680e9ad090c0000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac0000000001000030690daf561c0bb58d6d6c6dc0127dbb89ff79ed1fc1b806189f20577a99d2915fd9a208a27e10b94dce3fd064fea3b2433e223a153926b77064cd2c1bed914b12e94fdd5fffff7f20000000000900000005045ab7073a4461f23ffed0fc957b0aca363f049cacdbbf53928a1466d1dba6cd326a1cdffbea2fc895556d32712fc9bf90a1d1fee0da48d01f007f9102583e8cb5f774d5338fa9c2727e89f0258eb49b14db2e86f78efbfd5695e27a526b512d2fd94e2add3c83075f3782168827c8b656867c850d6d15daa3bb60ecb5185f1e47b68947c809957d95677d114babf23f2bc3b1d4256c98ca8e81f4eac55cc735023b0002000000";

    std::string strD21 = "440022734e7a3945434b337344434170375a4e7541525478666f454b67744367355a75774480412005000000000200000002f9176abeaaea8230461dad28bf13ffb02e0b3da541e7d4411dbdb86ea3dd2269000000006b483045022100899ebc13ddce60b08521f84f01b4ed30ec596ad83bb880433fbf25ddd54e76890220121541b1954eaef3c0f7c7e53152a3b0f41bc549c4140322439a0b2acccbb2e8012102b022de67d82c49215e73e8d6d3e4ddc9cb98e17937f78cd2c55c6fa92c06cc53ffffffff326a1cdffbea2fc895556d32712fc9bf90a1d1fee0da48d01f007f9102583e8c020000008b483045022100d9844386537182e367d597db903c8af8f0a7f5c10a8b493047198856b01826a502206a035f9302e973ce97ca582920cd18fbedf814b4fe25098a4cf8e8e797685d700141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff03357adb6a000000001976a914d372781bafc63f7719aeaf0531bda6ce9df4462a88ac0000000000000000246a22734e7a3945434b337344434170375a4e7541525478666f454b67744367355a757744002bce0e0c0000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac0000000001000030690daf561c0bb58d6d6c6dc0127dbb89ff79ed1fc1b806189f20577a99d2915fd9a208a27e10b94dce3fd064fea3b2433e223a153926b77064cd2c1bed914b12e94fdd5fffff7f20000000000900000005045ab7073a4461f23ffed0fc957b0aca363f049cacdbbf53928a1466d1dba6cd326a1cdffbea2fc895556d32712fc9bf90a1d1fee0da48d01f007f9102583e8cb5f774d5338fa9c2727e89f0258eb49b14db2e86f78efbfd5695e27a526b512d2fd94e2add3c83075f3782168827c8b656867c850d6d15daa3bb60ecb5185f1e47b68947c809957d95677d114babf23f2bc3b1d4256c98ca8e81f4eac55cc735025b0002000000";

    std::string strD22 = "440022734e7a3945434b337344434170375a4e7541525478666f454b67744367355a7577448041200500000000020000000247fdcea35047f3fac49122d03842aeec4d6ed432bac835eacec1f1885e8e2254000000006b483045022100a6fb9df432b684de3d8771364f95e44e28dd268a5ae26c1109e6ae09a6523bd50220403a2a79eff666d5f809df7e92635f616bf9509af231817a6064fcef017565d5012102d443bd3e761c461692efea809017e264096530697cb702608b0cd77af5859b1bffffffffb5f774d5338fa9c2727e89f0258eb49b14db2e86f78efbfd5695e27a526b512d020000008b483045022100ecfa3ecf42266a554377f14f0468a21db5789061c58c6d33f65062237fbaedee022053d6bfe98e003dfccef37a935367cad237602b223ee30e12bb983baa129ea56b0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff03f5c08d89000000001976a9148fcc76fe1cef407df0647d55a9a736a35cc7258788ac0000000000000000246a22734e7a3945434b337344434170375a4e7541525478666f454b67744367355a757744806cee130c0000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac0000000001000030690daf561c0bb58d6d6c6dc0127dbb89ff79ed1fc1b806189f20577a99d2915fd9a208a27e10b94dce3fd064fea3b2433e223a153926b77064cd2c1bed914b12e94fdd5fffff7f20000000000900000005045ab7073a4461f23ffed0fc957b0aca363f049cacdbbf53928a1466d1dba6cd786f95f0140f6c78c1e4a59ef3542f79fd13f38c7ba61cd573d2eb65c44bd80fcf45da83350c71e10ecec6671be0e69911e418e4742d814dab5f60f3225911205291f45e6792fd93a5eed4d1234ad7f82352ee87fd10c549c6e2d2783204ac5e47b68947c809957d95677d114babf23f2bc3b1d4256c98ca8e81f4eac55cc735026b0002000000";

    std::string strD23 = "440022734e7a3945434b337344434170375a4e7541525478666f454b67744367355a75774480412005000000000200000002847f807ffc4568c4a420286b8eb65fb11b4ab5c3ce0a14246f6656a6c3f30700000000006a47304402205f02e95d81dae45e3bb86fff60ba21b0806add864705d2d68c586c7063d01fa802204705798a2029dd14687a63f0885c2f59b108c72181435c28ba7cf171a020e703012102284f5aa9b1fab38b0b085bc1a6e9c8377bf981991ccf317d4db8e98f905ca654ffffffffcf45da83350c71e10ecec6671be0e69911e418e4742d814dab5f60f322591120020000008b483045022100d3375001a0e9f037ed96f24f01922ee17d840658abbeedb4997e59a85c870a4d022038cea240c3f870ab8e4eae3f12c4fed382111e39d997e712067985b10dad5e110141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0340e5028c000000001976a914d4df8a19ce7445427169e5e33d4bef3528a842f588ac0000000000000000246a22734e7a3945434b337344434170375a4e7541525478666f454b67744367355a75774400ae0e190c0000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac0000000001000030690daf561c0bb58d6d6c6dc0127dbb89ff79ed1fc1b806189f20577a99d2915fd9a208a27e10b94dce3fd064fea3b2433e223a153926b77064cd2c1bed914b12e94fdd5fffff7f20000000000900000005045ab7073a4461f23ffed0fc957b0aca363f049cacdbbf53928a1466d1dba6cd786f95f0140f6c78c1e4a59ef3542f79fd13f38c7ba61cd573d2eb65c44bd80fcf45da83350c71e10ecec6671be0e69911e418e4742d814dab5f60f3225911205291f45e6792fd93a5eed4d1234ad7f82352ee87fd10c549c6e2d2783204ac5e47b68947c809957d95677d114babf23f2bc3b1d4256c98ca8e81f4eac55cc73502ab0002000000";

    std::string strD24 = "440022734d7476636a4e533343655642696f6e4151517959527235683558543732795a4439804120050000000002000000020695c71009bcb6f1e3dfcf5845ff3f208a57dfe4122697c5e465f08c68d36f4c000000006a473044022020d776b03179bfc3a527b1d8f4931145ef4aa829c78cd0858e04121f96a581be0220211af0b1c78abe055fb3e3bc597feea3edfac74aecfd41bb6d504319fc2d7557012102bbc416f750103ec1285d02b6c1d7188da5cd35823ba361d03aa1674988978feaffffffff5291f45e6792fd93a5eed4d1234ad7f82352ee87fd10c549c6e2d2783204ac5e020000008b483045022100fff3f6cd705cd943ea2946b30eb99c11abbc8106e1d210aeb44971a1cad17e510220179ecc472c5720bc3def64070899ef65902b085ab6834aa255900da8bd5d71150141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0340e5028c000000001976a914d1dbe37260e134b20932427acffd6abd82a951cb88ac0000000000000000246a22734d7476636a4e533343655642696f6e4151517959527235683558543732795a443980ef2e1e0c0000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac0000000001000030690daf561c0bb58d6d6c6dc0127dbb89ff79ed1fc1b806189f20577a99d2915fd9a208a27e10b94dce3fd064fea3b2433e223a153926b77064cd2c1bed914b12e94fdd5fffff7f200000000009000000022ddfb4cd731f7dffa8adef29eaa8d13d1866f2ab54a0b8c8a464cd57080bae169192733b593d8e401e7472cd2b951f2d90dc8aca4fea43d77b617db0813dbe51013d02000000";

    std::string strD25 = "44002273557a346a796237737551715550514d64556a586d6359446257576d443655625a6280412005000000000200000002326a1cdffbea2fc895556d32712fc9bf90a1d1fee0da48d01f007f9102583e8c000000006b483045022100ca0ff1017a8f40c4f73cc293c736ce6164f297d0040120b836da752c969894f202204834de3f570d7031dce8622b5d5fa6bdcd2b560d4c6085102f95ed2c49df84f90121036d2ac16968d75307355a4d1853465e2cd0aafe2d475be53a451e7cc6ce1b96f1ffffffff9192733b593d8e401e7472cd2b951f2d90dc8aca4fea43d77b617db0813dbe51020000008a47304402204272f63282f82074866783ec867cab429d446f3c4a92c6165af09f0d72fd094502202eb07a255dcccf06f83d826faa3ca33c3c8533453a1362f3bbea6db28b05023a0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff0380109c0a000000001976a91409a1828dd4de4b66995b35547ae9c909d1736f5c88ac0000000000000000246a2273557a346a796237737551715550514d64556a586d6359446257576d443655625a6200314f230c0000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac0000000001000030da13f902f7c105575b4b2049693181e62b12a44779061cd6061ac870b4674215a117fe6da31d381b76b9d5f31b54feb7ba2f0863535f0e5b814a6f3167abe64f3250dd5fffff7f2005000000080000000446d36c7b9baebde4d36f26dd6af09196d1225a3d5df31caf00b836ca3b3227d758e72fb926bc59126c11d773cf869cc6cb70245a6ab4cd95064828680aa90e70ced232126b70f6dfa11b2e546e8c03f7edeaf88c0f60ebfc2820a315cc3bc6bdb4a3de7a66f31069525950d2ee3f8278b625d8aeef9e01768ce320461b9ad87e011702000000";

    std::string strD26 = "44002273557a346a796237737551715550514d64556a586d6359446257576d443655625a6200e1f505000000000200000002c0ad016bce021b27b77302e3493f3f83ced41921f07ae00457346acf516819aa000000006a47304402203900b3c6a72f62b67e1007981af35dfd7d0be4ec85249d3f0d89ad593146c3e102207c3267b1f6bf979a09495e1fcd400fa21a72c76c8678835550f53b6e1a2ec98f012103de584ee7d21a47239ad121a44c81fc979a3b71b6673c4fe4f01f3f3501e6e3b7ffffffff58e72fb926bc59126c11d773cf869cc6cb70245a6ab4cd95064828680aa90e70020000008b483045022100bb4d5db4acc0e773c2f09bee61e735710336394844be376a508ce5bbb58675c002206c8c478052667bb109991f0f80f04154ca2f702705b3a14823f26e16197267700141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff030071c609000000001976a91435e1e547c27b0e148b19487e6320a12b44ad9f5788ac0000000000000000246a2273557a346a796237737551715550514d64556a586d6359446257576d443655625a62001245290c0000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac0000000001000030da13f902f7c105575b4b2049693181e62b12a44779061cd6061ac870b4674215a117fe6da31d381b76b9d5f31b54feb7ba2f0863535f0e5b814a6f3167abe64f3250dd5fffff7f2005000000080000000464e826c583f3b540c36ac5ed665f7f9000a91d8dcaf7ea4403fb002018d5800b5cee002af05176960ad28cbfb8953eccbd5d4632d3a6156c7c1a6af6edcd8b18eaade2927416e14b8894be67f44945dcd3bb4465f7e8b28a1c4c615b2852766ab4a3de7a66f31069525950d2ee3f8278b625d8aeef9e01768ce320461b9ad87e011b02000000";

    std::string strD27 = "44002273594c7644577a5467586955587a4c79413941375970517a66396b784d764336354700e1f5050000000002000000026be4ca00a382074d3b083973c95e3541de6b8c2619060b74633ade0d593a450e000000006a47304402200ac5a227f72f89a684dfe25252646cbc3cf5fd13be023875d7360d3c03f65ba602200ccb5c8877789ddedced33533d7100ddc05ac888aaa0fecb56e4b7d42f45e4280121035207ab86bc76c2fc3ff395bf04a98e837973c961e8726130635826e011569823ffffffff5cee002af05176960ad28cbfb8953eccbd5d4632d3a6156c7c1a6af6edcd8b18020000008a47304402207d4c70b137c5deb24a82a48a9a0534bac973c3302f01860f652071e7a5ee6de2022063f13bc08c1897b9105b5997b6156ca5c37caceef302256ab9dd9b9e2496221c0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff038085b50d000000001976a914fc91d685d888c2983ccc1883eeda9348fe477f3388ac0000000000000000246a2273594c7644577a5467586955587a4c79413941375970517a66396b784d764336354700f33a2f0c0000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac0000000001000030da13f902f7c105575b4b2049693181e62b12a44779061cd6061ac870b4674215a117fe6da31d381b76b9d5f31b54feb7ba2f0863535f0e5b814a6f3167abe64f3250dd5fffff7f2005000000080000000464e826c583f3b540c36ac5ed665f7f9000a91d8dcaf7ea4403fb002018d5800b5cee002af05176960ad28cbfb8953eccbd5d4632d3a6156c7c1a6af6edcd8b18eaade2927416e14b8894be67f44945dcd3bb4465f7e8b28a1c4c615b2852766ab4a3de7a66f31069525950d2ee3f8278b625d8aeef9e01768ce320461b9ad87e012b02000000";

    std::string strD28 = "44002273594c7644577a5467586955587a4c79413941375970517a66396b784d764336354700e1f505000000000200000002d19a6e707836fb2d6fb187c9835b0dee0b11841562b8740ac932c2157fa96885000000006b483045022100955035b79a6de003a30b3c924bb0f2d4006ba8586510106daae28c1ace5ab56d0220559186dc384dff41a88b28e3701e64e2e4d5d8597334c021bb76c7f42329f8a0012102d18f5a2506239d64a8d22512ed907b18631d1ab9e85bbbc2258047041d6347a4ffffffffeaade2927416e14b8894be67f44945dcd3bb4465f7e8b28a1c4c615b2852766a020000008a473044022001fe94b66afd2a8ae9038e0455cf07972ce0717c3f33a927df4b3a93dd3373aa0220566b5757a4b3c075f554d8153a008e3049ce6e7871fefae4fb76eef6c39535b30141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff034018a327000000001976a9144f8d641e8a70c6e3983bf2bd8da385a781f7566288ac0000000000000000246a2273594c7644577a5467586955587a4c79413941375970517a66396b784d764336354700d430350c0000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac0000000001000030da13f902f7c105575b4b2049693181e62b12a44779061cd6061ac870b4674215a117fe6da31d381b76b9d5f31b54feb7ba2f0863535f0e5b814a6f3167abe64f3250dd5fffff7f20050000000800000004085af8e206f2faa58811bb4978241b0320bd220b7ef44db6fde017312e78f2823df3a2d54b1e11700588a5125675c68918478cc24b30e4f2424e3b343eb2cf9ff7f51cc0f6a02f62f222561c2e356d910d2416d9d62294d9253dfe223bae5e365a10f636d8d56d75d42c424b4dd6f6fa6a322d3e047f7f88fa6fbe4bb71ee652011d02000000";

    std::string strD29 = "44002273596974747132366171726f39545a6669756e4234704d753654375541355259704a00c2eb0b000000000200000002b5f774d5338fa9c2727e89f0258eb49b14db2e86f78efbfd5695e27a526b512d000000006a473044022078bc53d16ff7cc1065942198434ba5ff6b9913cf66c7e721dd67dfab315607b802202b6aeae9f7e17f59c67833233ec83aef6774974772bcf189e58c8f699810db5701210258cf6692be1b37b6139127ca3e67780441886eda1bbb0d9d19114570f12509c2ffffffff3df3a2d54b1e11700588a5125675c68918478cc24b30e4f2424e3b343eb2cf9f020000008a4730440220413663372afbf66773cb122f4f51d7f53fa615a627dc54ede4bc66f78f46707902207d420c070a933ba3437926568c933acdfa4b17524a167c058f396e905221c8e00141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff03f56ca35e000000001976a914fb9f4e6a817e6b5abd10848025722f49f5adcdc388ac0000000000000000246a2273596974747132366171726f39545a6669756e4234704d753654375541355259704a00961c410c0000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac0000000001000030da13f902f7c105575b4b2049693181e62b12a44779061cd6061ac870b4674215a117fe6da31d381b76b9d5f31b54feb7ba2f0863535f0e5b814a6f3167abe64f3250dd5fffff7f20050000000800000004085af8e206f2faa58811bb4978241b0320bd220b7ef44db6fde017312e78f2823df3a2d54b1e11700588a5125675c68918478cc24b30e4f2424e3b343eb2cf9ff7f51cc0f6a02f62f222561c2e356d910d2416d9d62294d9253dfe223bae5e365a10f636d8d56d75d42c424b4dd6f6fa6a322d3e047f7f88fa6fbe4bb71ee652012d02000000";

    std::string strD30 = "440022736162696a6d6967466577694b474c556d4d686357314b454b39566b31685261343800a3e111000000000200000002cf45da83350c71e10ecec6671be0e69911e418e4742d814dab5f60f322591120000000006a47304402205bb710e0d438daeed19abd9608b10ad61893e68460110181c88b42fd538805ad022008033c254a95d916488784c1c07c9772dd46d394426361bfc20bc38de4fe609001210381559f8c7b1add397ab17ed2f7922b18a85d8da019971e64cedb4bfb9b837573fffffffff7f51cc0f6a02f62f222561c2e356d910d2416d9d62294d9253dfe223bae5e36020000008a4730440220695474e797626c1a4d1642bf365d3b8632eca2f74b175f542414aaf79cae66bd0220115561f7876219bf31e29158a6df3e00ece73091ea96f88380b80f1ae925c45b0141043a6a472d711c6b4751af0cf82f397909469f943788f89bb7dfb1292d2a40e662ef2c32e6798315cc5fc21432e1db5513de3ddb3bda295199b065959cd76cf01cffffffff03b5d25f77000000001976a91488728bdfe80dd60342eff83922becf9ad2838d3888ac0000000000000000246a22736162696a6d6967466577694b474c556d4d686357314b454b39566b3168526134380039fe520c0000001976a91458c63096724814c3dcdf088b9bb0dc48e6e1a89c88ac0000000001000030da13f902f7c105575b4b2049693181e62b12a44779061cd6061ac870b4674215a117fe6da31d381b76b9d5f31b54feb7ba2f0863535f0e5b814a6f3167abe64f3250dd5fffff7f20050000000800000004085af8e206f2faa58811bb4978241b0320bd220b7ef44db6fde017312e78f282186c781b3920507b83eada097f528f8c7c981660e1b9abc525076d1969af0b46d6638e5c6ec995af89d7e7752859bf9443045e21c3486d493c7f52d85b119685b756a2efcb6833e05352c4c1b0017911c119e6010018e6a4b8316a42faf363b1013502000000";

    CDataStream ss1(ParseHex(strD1), SER_DISK, CLIENT_VERSION);
    CDataStream ss2(ParseHex(strD2), SER_DISK, CLIENT_VERSION);
    CDataStream ss3(ParseHex(strD3), SER_DISK, CLIENT_VERSION);
    CDataStream ss4(ParseHex(strD4), SER_DISK, CLIENT_VERSION);
    CDataStream ss5(ParseHex(strD5), SER_DISK, CLIENT_VERSION);
    CDataStream ss6(ParseHex(strD6), SER_DISK, CLIENT_VERSION);
    CDataStream ss7(ParseHex(strD7), SER_DISK, CLIENT_VERSION);
    CDataStream ss8(ParseHex(strD8), SER_DISK, CLIENT_VERSION);
    CDataStream ss9(ParseHex(strD9), SER_DISK, CLIENT_VERSION);
    CDataStream ss10(ParseHex(strD10), SER_DISK, CLIENT_VERSION);
    CDataStream ss11(ParseHex(strD11), SER_DISK, CLIENT_VERSION);
    CDataStream ss12(ParseHex(strD12), SER_DISK, CLIENT_VERSION);
    CDataStream ss13(ParseHex(strD13), SER_DISK, CLIENT_VERSION);
    CDataStream ss14(ParseHex(strD14), SER_DISK, CLIENT_VERSION);
    CDataStream ss15(ParseHex(strD15), SER_DISK, CLIENT_VERSION);
    CDataStream ss16(ParseHex(strD16), SER_DISK, CLIENT_VERSION);
    CDataStream ss17(ParseHex(strD17), SER_DISK, CLIENT_VERSION);
    CDataStream ss18(ParseHex(strD18), SER_DISK, CLIENT_VERSION);
    CDataStream ss19(ParseHex(strD19), SER_DISK, CLIENT_VERSION);
    CDataStream ss20(ParseHex(strD20), SER_DISK, CLIENT_VERSION);
    CDataStream ss21(ParseHex(strD21), SER_DISK, CLIENT_VERSION);
    CDataStream ss22(ParseHex(strD22), SER_DISK, CLIENT_VERSION);
    CDataStream ss23(ParseHex(strD23), SER_DISK, CLIENT_VERSION);
    CDataStream ss24(ParseHex(strD24), SER_DISK, CLIENT_VERSION);
    CDataStream ss25(ParseHex(strD25), SER_DISK, CLIENT_VERSION);
    CDataStream ss26(ParseHex(strD26), SER_DISK, CLIENT_VERSION);
    CDataStream ss27(ParseHex(strD27), SER_DISK, CLIENT_VERSION);
    CDataStream ss28(ParseHex(strD28), SER_DISK, CLIENT_VERSION);
    CDataStream ss29(ParseHex(strD29), SER_DISK, CLIENT_VERSION);
    CDataStream ss30(ParseHex(strD30), SER_DISK, CLIENT_VERSION);

    // Unserialize the testing deposits

    SidechainDeposit d1;
    ss1 >> d1;
    SidechainDeposit d2;
    ss2 >> d2;
    SidechainDeposit d3;
    ss3 >> d3;
    SidechainDeposit d4;
    ss4 >> d4;
    SidechainDeposit d5;
    ss5 >> d5;
    SidechainDeposit d6;
    ss6 >> d6;
    SidechainDeposit d7;
    ss7 >> d7;
    SidechainDeposit d8;
    ss8 >> d8;
    SidechainDeposit d9;
    ss9 >> d9;
    SidechainDeposit d10;
    ss10 >> d10;
    SidechainDeposit d11;
    ss11 >> d11;
    SidechainDeposit d12;
    ss12 >> d12;
    SidechainDeposit d13;
    ss13 >> d13;
    SidechainDeposit d14;
    ss14 >> d14;
    SidechainDeposit d15;
    ss15 >> d15;
    SidechainDeposit d16;
    ss16 >> d16;
    SidechainDeposit d17;
    ss17 >> d17;
    SidechainDeposit d18;
    ss18 >> d18;
    SidechainDeposit d19;
    ss19 >> d19;
    SidechainDeposit d20;
    ss20 >> d20;
    SidechainDeposit d21;
    ss21 >> d21;
    SidechainDeposit d22;
    ss22 >> d22;
    SidechainDeposit d23;
    ss23 >> d23;
    SidechainDeposit d24;
    ss24 >> d24;
    SidechainDeposit d25;
    ss25 >> d25;
    SidechainDeposit d26;
    ss26 >> d26;
    SidechainDeposit d27;
    ss27 >> d27;
    SidechainDeposit d28;
    ss28 >> d28;
    SidechainDeposit d29;
    ss29 >> d29;
    SidechainDeposit d30;
    ss30 >> d30;

    std::vector<SidechainDeposit> vDeposit { d1, d2, d3, d4, d5, d6, d7, d8,
        d9, d10, d11, d12, d13, d14, d15, d16, d17, d18, d19, d20, d21, d22,
        d23, d24, d25, d26, d27, d28, d29, d30 };

    // Enable this for debugging
    //int i = 0;
    //for (const SidechainDeposit& d : vDeposit) {
    //    std::cout << "Deposit " << i << ":\n";
    //    std::cout << d.ToString() << std::endl;
    //    i++;
    //}

    return vDeposit;
}

BOOST_AUTO_TEST_CASE(sidechain_deposit_sort_10_deposits)
{
    // This test is testing 10 deposits which all spend different transactions

    // Get 10 deposits in valid CTIP spend order
    std::vector<SidechainDeposit> vD = Get10TestDeposits();

    // Test sorting the deposits when they are already in valid order
    std::vector<SidechainDeposit> vDepositSorted;
    BOOST_CHECK(SortDeposits(vD, vDepositSorted));
    BOOST_CHECK(vD == vDepositSorted);

    vDepositSorted.clear();

    // Test sorting from reverse order
    std::vector<SidechainDeposit> vReverse = vD;
    std::reverse(vReverse.begin(), vReverse.end());
    BOOST_CHECK(SortDeposits(vReverse, vDepositSorted));
    BOOST_CHECK(vD == vDepositSorted);

    vDepositSorted.clear();

    // Test sorting a random order
    std::vector<SidechainDeposit> vRandom {vD[1], vD[0], vD[3], vD[2], vD[4],
        vD[5], vD[7], vD[6], vD[9], vD[8]};

    BOOST_CHECK(vRandom != vD);
    BOOST_CHECK(SortDeposits(vRandom, vDepositSorted));
    BOOST_CHECK(vDepositSorted == vD);
}

BOOST_AUTO_TEST_CASE(sidechain_deposit_sort_30_deposits)
{
    // This test is testing 30 deposits some of which spend different outputs
    // of the same transaction

    // Get 30 deposits in valid CTIP spend order
    std::vector<SidechainDeposit> vD = Get30TestDeposits();

    // Test sorting the deposits when they are already in valid order
    std::vector<SidechainDeposit> vDepositSorted;
    BOOST_CHECK(SortDeposits(vD, vDepositSorted));
    BOOST_CHECK(vD == vDepositSorted);

    vDepositSorted.clear();

    // Test sorting from reverse order
    std::vector<SidechainDeposit> vReverse = vD;
    std::reverse(vReverse.begin(), vReverse.end());
    BOOST_CHECK(SortDeposits(vReverse, vDepositSorted));
    BOOST_CHECK(vD == vDepositSorted);

    vDepositSorted.clear();

    // Test sorting random order
    std::vector<SidechainDeposit> vRandom {vD[1], vD[0], vD[21], vD[16], vD[4],
        vD[24], vD[15], vD[7], vD[9], vD[8], vD[13], vD[11], vD[12], vD[10],
        vD[14], vD[6], vD[3], vD[17], vD[20], vD[19], vD[18], vD[2], vD[28],
        vD[22], vD[23], vD[5], vD[25], vD[29], vD[26], vD[27]};

    BOOST_CHECK(vRandom != vD);
    BOOST_CHECK(SortDeposits(vRandom, vDepositSorted));
    BOOST_CHECK(vDepositSorted == vD);
}

BOOST_AUTO_TEST_CASE(IsWTPrimeFailCommit)
{
    uint256 hashWTPrime = GetRandHash();

    CScript script =  GenerateWTPrimeFailCommit(hashWTPrime);

    uint256 hashWTPrimeFromCommit;
    BOOST_CHECK(script.IsWTPrimeFailCommit(hashWTPrimeFromCommit));

    BOOST_CHECK(hashWTPrime == hashWTPrimeFromCommit);
}

BOOST_AUTO_TEST_CASE(IsWTPrimeSpentCommit)
{
    uint256 hashWTPrime = GetRandHash();

    CScript script = GenerateWTPrimeSpentCommit(hashWTPrime);

    uint256 hashWTPrimeFromCommit;
    BOOST_CHECK(script.IsWTPrimeSpentCommit(hashWTPrimeFromCommit));

    BOOST_CHECK(hashWTPrime == hashWTPrimeFromCommit);
}

BOOST_AUTO_TEST_CASE(WTFeeEncoding)
{
    CAmount amount;
    CAmount amountRead;
    CScript script;

    // Test 1 * COIN
    amount = COIN;
    script = EncodeWTFees(amount);
    BOOST_CHECK(DecodeWTFees(script, amountRead));
    BOOST_CHECK(amountRead == amount);

    // Test 1 * CENT
    amount = CENT;
    script = EncodeWTFees(amount);
    BOOST_CHECK(DecodeWTFees(script, amountRead));
    BOOST_CHECK(amountRead == amount);

    // Test with a negative number
    amount = -1000000;
    script = EncodeWTFees(amount);
    BOOST_CHECK(DecodeWTFees(script, amountRead));
    BOOST_CHECK(amountRead == amount);

    // Test incrementing from 0.01 to 21 by 1 * CENT
    amount = 0;
    while (amount < 21 * COIN) {
        amount += CENT;
        script = EncodeWTFees(amount);

        BOOST_CHECK(DecodeWTFees(script, amountRead));
        BOOST_CHECK(amountRead == amount);
    }

    // Test number greater than CScriptNum default 4 byte integer limit
    amount = 22 * COIN;
    amountRead = 0;
    script = EncodeWTFees(amount);
    BOOST_CHECK(DecodeWTFees(script, amountRead));
    BOOST_CHECK(amount == amountRead);

    // Test high number
    amount = MAX_MONEY;
    amountRead = 0;
    script = EncodeWTFees(amount);
    BOOST_CHECK(DecodeWTFees(script, amountRead));
    BOOST_CHECK(amount == amountRead);
}

BOOST_AUTO_TEST_CASE(wt_refund_script)
{
    // Test a valid WT refund message / script

    std::string strRefundAddress = "sVf5Jjy6EuVdq2oKFDaQAxb6rTYbmQZAPT";
    CTxDestination dest = DecodeDestination(strRefundAddress);

    BOOST_CHECK(IsValidDestination(dest));

    // Checking that the destination is for a KeyID
    const CKeyID* id = boost::get<CKeyID>(&dest);
    BOOST_REQUIRE(id);

    // Normally this would come from the users sidechain wallet
    std::string strPrivKey = "cVS8pYc1uyM1R64QEvPzJHiJn84q9Agd3mCHvyvFTf3zmCTXNAh4";

    CBitcoinSecret vchSecret;
    BOOST_CHECK(vchSecret.SetString(strPrivKey));

    CKey privKey = vchSecret.GetKey();
    BOOST_CHECK(privKey.IsValid());

    // Add WT to psidechaintree
    SidechainWT wt;
    wt.nSidechain = 0;
    wt.strDestination = "";
    wt.strRefundDestination = strRefundAddress;
    wt.amount = 0;
    wt.mainchainFee = 0;
    wt.status = WT_UNSPENT;
    wt.hashBlindWTX = uint256();

    psidechaintree->WriteWTUpdate(std::vector<SidechainWT> { wt });

    uint256 hashMessage = GetWTRefundMessageHash(wt.GetID());

    // We are really only signing the hash of the message
    std::vector<unsigned char> vchSig;
    BOOST_CHECK(privKey.SignCompact(hashMessage, vchSig));

    // Generate refund request script
    CScript script = GenerateWTRefundRequest(wt.GetID(), vchSig);

    // Check refund script
    uint256 idFromScript;
    std::vector<unsigned char> vchSigFromScript;
    BOOST_CHECK(script.IsWTRefundRequest(idFromScript, vchSigFromScript));
    BOOST_CHECK(idFromScript == wt.GetID());
    BOOST_CHECK(vchSigFromScript == vchSig);

    // Verify refund script
    SidechainWT wtOut;
    BOOST_CHECK(VerifyWTRefundRequest(idFromScript, vchSigFromScript, wtOut));

    // Verify again ourselves
    CPubKey pubkey;
    BOOST_CHECK(pubkey.RecoverCompact(hashMessage, vchSig));

    BOOST_CHECK(pubkey.GetID() == privKey.GetPubKey().GetID());
    BOOST_CHECK(CTxDestination(pubkey.GetID()) == dest);
}

BOOST_AUTO_TEST_CASE(wt_refund_script_invalid_address)
{
    // Test a WT refund script with invalid address / signature

    std::string strRefundAddress = "sVf5Jjy6EuVdq2oKFDaQAxb6rTYbmQZAPT";
    CTxDestination dest = DecodeDestination(strRefundAddress);

    BOOST_CHECK(IsValidDestination(dest));

    // Checking that the destination is for a KeyID
    const CKeyID* id = boost::get<CKeyID>(&dest);
    BOOST_REQUIRE(id);

    // Normally this would come from the users sidechain wallet
    std::string strPrivKey = "cVS8pYc1uyM1R64QEvPzJHiJn84q9Agd3mCHvyvFTf3zmCTXNAh4";

    CBitcoinSecret vchSecret;
    BOOST_CHECK(vchSecret.SetString(strPrivKey));

    CKey privKey = vchSecret.GetKey();
    BOOST_CHECK(privKey.IsValid());

    // We will set the refund address to an address different from the one we
    // sign the message with and check that it is rejected.
    std::string strOtherAdress = "sSnLM62jFg5XHiHdN1nzbQ9dHXzUnZS2kP";

    // Add WT to psidechaintree
    SidechainWT wt;
    wt.nSidechain = 0;
    wt.strDestination = "";
    wt.strRefundDestination = strOtherAdress;
    wt.amount = 0;
    wt.mainchainFee = 0;
    wt.status = WT_UNSPENT;
    wt.hashBlindWTX = uint256();

    psidechaintree->WriteWTUpdate(std::vector<SidechainWT> { wt });

    uint256 hashMessage = GetWTRefundMessageHash(wt.GetID());

    // We are really only signing the hash of the message
    std::vector<unsigned char> vchSig;
    BOOST_CHECK(privKey.SignCompact(hashMessage, vchSig));

    // Generate refund request script
    CScript script = GenerateWTRefundRequest(wt.GetID(), vchSig);

    // Check refund script
    uint256 idFromScript;
    std::vector<unsigned char> vchSigFromScript;
    BOOST_CHECK(script.IsWTRefundRequest(idFromScript, vchSigFromScript));
    BOOST_CHECK(idFromScript == wt.GetID());
    BOOST_CHECK(vchSigFromScript == vchSig);

    // Refund script should be invalid
    SidechainWT wtOut;
    BOOST_CHECK(!VerifyWTRefundRequest(idFromScript, vchSigFromScript, wtOut));
}

BOOST_AUTO_TEST_CASE(wt_refund_script_invalid_wtid)
{
    // Test a WT refund script with invalid WT ID

    std::string strRefundAddress = "sVf5Jjy6EuVdq2oKFDaQAxb6rTYbmQZAPT";
    CTxDestination dest = DecodeDestination(strRefundAddress);

    BOOST_CHECK(IsValidDestination(dest));

    // Checking that the destination is for a KeyID
    const CKeyID* id = boost::get<CKeyID>(&dest);
    BOOST_REQUIRE(id);

    // Normally this would come from the users sidechain wallet
    std::string strPrivKey = "cVS8pYc1uyM1R64QEvPzJHiJn84q9Agd3mCHvyvFTf3zmCTXNAh4";

    CBitcoinSecret vchSecret;
    BOOST_CHECK(vchSecret.SetString(strPrivKey));

    CKey privKey = vchSecret.GetKey();
    BOOST_CHECK(privKey.IsValid());

    // Add WT to psidechaintree
    SidechainWT wt;
    wt.nSidechain = 0;
    wt.strDestination = "";
    wt.strRefundDestination = strRefundAddress;
    wt.amount = 0;
    wt.mainchainFee = 0;
    wt.status = WT_UNSPENT;
    wt.hashBlindWTX = uint256();

    psidechaintree->WriteWTUpdate(std::vector<SidechainWT> { wt });

    // Put an invalid WT ID in the message
    uint256 hashMessage = GetWTRefundMessageHash(GetRandHash());

    // We are really only signing the hash of the message
    std::vector<unsigned char> vchSig;
    BOOST_CHECK(privKey.SignCompact(hashMessage, vchSig));

    // Generate refund request script
    CScript script = GenerateWTRefundRequest(wt.GetID(), vchSig);

    // Check refund script
    uint256 idFromScript;
    std::vector<unsigned char> vchSigFromScript;
    BOOST_CHECK(script.IsWTRefundRequest(idFromScript, vchSigFromScript));
    BOOST_CHECK(idFromScript == wt.GetID());
    BOOST_CHECK(vchSigFromScript == vchSig);

    // Refund script should be invalid
    SidechainWT wtOut;
    BOOST_CHECK(!VerifyWTRefundRequest(idFromScript, vchSigFromScript, wtOut));
}


BOOST_AUTO_TEST_CASE(depositaddress)
{
    // Generate a deposit address for dogechain (0) and make sure the format
    // matches what we expect.
    std::string strDest = "patrick";

    std::string strDepositAddress = GenerateDepositAddress(strDest);

    BOOST_CHECK(strDepositAddress == "s0_patrick_643e86");

    // Parsing should return just "patrick"
    std::string strOut = "";
    unsigned int nSidechain;
    BOOST_CHECK(ParseDepositAddress(strDepositAddress, strOut, nSidechain));
    BOOST_CHECK(strOut == "patrick");
    BOOST_CHECK(nSidechain == THIS_SIDECHAIN);

}

BOOST_AUTO_TEST_SUITE_END()
